/*-RSL----------------------------------------------------JV R-Style--*/
/*--------------- ▐╔Г═БЛ ╛╔╛╝Ю╗═╚Л╜╝ё╝ ╝Ю╓╔Ю═ ------------------------*/
 import plcommon,plcomrep;
 import brkstr, bankinter, vrslplat, i2order, fncommon, fm_all;

 record d (arhdoc  , "bank.def");
 FILE pers(person  , "bank.def");
 FILE sc  (symbcash, "bank.def");
 FILE cl  (client  , "bank.def");
 FILE clf (claddfrm, "bank.def");
 FILE acc (account , "bank.def");

 private array Symb, SymbSum;
 private var j;

/* ----------------------------------------------------- */
/* ┌К╒╝╓ ╓═БК Г╔Ю╔╖ Б╝Г╙Ц   */
macro PutDatePoint( dat )
    Var Day, Mon, Year;
   datesplit( dat, Day, Mon, Year );
   return LZ(Day,2) + "." + LZ(Mon,2) + "." + LZ(Year,4);
end;

/* ----------------------------------------------------- */

macro PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, ndoc, nsheet)

var n, Ground="", , sumtostr="", SP, SR, SBR, SBP, NSP, NSR, SG, SS;
SP = SR = SBP = SBR = NSP = NSR = SG = SS = TArray(0, 1) ;

if ( d.Date_Document < {Date2161U} )

   SS  = DoStrSplit( rubtostralt( d.Sum ), 76,76,2 );
   SG  = DoStrSplit( d.Ground,        67, 67, 3 );
   SBP = DoStrSplit( d.Bank_Payer,    43, 43, 2 );
   SBR = DoStrSplit( d.Bank_Receiver, 43, 43, 2 );
   SP  = DoStrSplit( Payer,           43, 43, 10);
   SR  = DoStrSplit( Receiver,        43, 43, 10);
[

  зддддддддддддддддддддддддддбдддддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддд©
  Ё    ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ N  Ё ############### Ё #######################    ■╝Ю╛═ N 0401108 Ё
  Ё                          юддддддддддддддддды ддддддддддддддддддддддд                    Ё
  Ё                                                     /└═Б═/                              Ё
  цддддддддддбдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
  Ё ▒Ц╛╛═    Ё ############################################################################ Ё
  Ё ╞Ю╝╞╗АЛН Ё ############################################################################ Ё
  цддддддддддаддддддддддддддддддддддддддддддддддбддддддддддбдддддддддддддддддддддддддддддддд╢
  Ё ########################################### Ё  ▒Ц╛╛═   Ё ############################   Ё
  Ё ########################################### Ё          Ё                                Ё]
    ( d.Numb_Document:c,
       strDateDoc:c,
       SS(0), SS(1),
       SP(0), Sum:r,
       SP(1));

    n = 2;
    while ( ( n<9 ) AND ( SP(n+1)!="") )
[ Ё ########################################### Ё          Ё                                Ё]( SP(n));
    n = n+1;
    end;

[ Ё ########################################### цддддддддддедддддддддддддддддддддддддддддддд╢
  Ё ▐╚═Б╔╚ЛИ╗╙                                  Ё  ▒Г.N    Ё #########################      Ё
  цдддддддддддддддддддддддддддддддддддддддддддддедддддддддд╢                                Ё
  Ё ########################################### Ё  │┬┼     Ё #################              Ё
  Ё ########################################### цдддддддддд╢                                Ё
  Ё │═╜╙ ╞╚═Б╔╚ЛИ╗╙═                            Ё  ▒Г.N    Ё #########################      Ё
  цдддддддддддддддддддддддддддддддддддддддддддддеддддддддддедддддддддддддддддддддддддддддддд╢
  Ё ########################################### Ё  │┬┼     Ё #################              Ё
  Ё ########################################### цдддддддддд╢                                Ё
  Ё │═╜╙ ╞╝╚ЦГ═Б╔╚О                             Ё  ▒Г.N    Ё #########################      Ё
  цдддддддддддддддддддддддддддддддддддддддддддддедддддддддд╢                                Ё
  Ё ########################################### Ё  ▒Г.N    Ё #########################      Ё
  Ё ########################################### цддддддддддеддддддддбддддддддддбдддддддддддд╢
  Ё ########################################### Ё ≤╗ДЮ.╓╝╙.Ё ###### Ё▒Ю╝╙ ╞╚═Б.Ё            Ё
  Ё ########################################### цдддддддддд╢        цдддддддддд╢            Ё
  Ё ########################################### Ё█═╖╜.╞╚═Б.Ё        Ё▌Г╔Ю.╞╚═Б.Ё ###        Ё]
  ( SP(n), d.Real_Payer,
       SBP(0), BIC_Payer,
       SBP(1), CorAcc_Payer,
       SBR(0), BIC_Receiver,
       SBR(1), CorAcc_Receiver,
       SR(0),  d.Real_Receiver,
       SR(1), SR(2), d.Shifr_oper,
       SR(3),
       SR(4), d.Payment);

     n = 5;
     while ( ( SR(n)!="") AND (n<10) )
         [ Ё ########################################### Ё          Ё        Ё          Ё            Ё]( SR(n));
     n = n+1;
     end;


[ Ё                                             Ё          Ё        Ё          Ё            Ё
  Ё ▐╝╚ЦГ═Б╔╚Л                                  Ё   ┼╝╓    Ё        Ё░╔╖.╞╝╚╔  Ё            Ё
  цдддддддддддддддддддддддддддддддддддддддддддддаддддддддддаддддддддаддддддддддадддддддддддд╢
  Ё █═╖╜═Г╔╜╗╔ ╞╚═Б╔╕═  ################################################################### Ё
  Ё ####################################################################################### Ё
  Ё ####################################################################################### Ё
  Ё                                                                                         Ё
  Ё                              ▐╝╓╞╗А╗                                                    Ё
  юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
  
    ] ( SG(0), SG(1), SG(2) );
elif ( d.Date_Document >= {Date2161U} )
 sumtostr =  rubtostralt( d.Sum );
 sumtostr = StrSubSt( sumtostr, SubStr( sumtostr, Index( sumtostr, "╙╝╞")+3), ".");
 SS =  DoStrSplit( sumtostr, 72, 72, 4);
 NSP = DoStrSplit( GetNameAc( d.Real_Payer, 1, 0 ), 40, 40, 3);
 NSR = DoStrSplit( GetNameAc( d.Real_Receiver, 1, 0), 40, 40, 3);

 strDateDoc =StrSubSt( strDateDoc, ".", "╝╓═");

 Ground = d.Ground+ " N " + d.Numb_Document + " ╝Б " + strDateDoc;
 SG = DoStrsplit( Ground,97, 97, 3 );

 Sum = string( d.Sum);
 if ( index(Sum,".00" ))
    Sum = StrSubSt( Sum, ".00", "=");
 else
    Sum = StrSubSt( Sum, ".", "-");
 end;

 [
                                                                                    здддддддддддддддд©
                                                                                    Ё  ┼╝╓ Д╝Ю╛К     Ё
                                                                                    Ё  ╓╝╙Ц╛╔╜Б═ ╞╝  Ё
                                                                                    Ё  ▌┼⌠└          Ё
                                                                                    цдддддддддддддддд╢
                                                                                    Ё   0401108      Ё
                                                                                    юдддддддддддддддды

      ###############################################################################################
    дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
      ▒╝АБ═╒╗Б╔╚Л

      ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ N   ###############            #######################
    дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                                                                └═Б═

    ддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддбддддддддддддддддддддддддддддддд
      █═╗╛╔╜╝╒═╜╗╔ АГ╔Б═                      Ё      └╔║╔Б АГ╔Б═        Ё▒Ц╛╛═ Ф╗ДЮ═╛╗
    ддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддддддддддедддддддддддддддбддддддддддддддд
      ########################################Ё#########################Ё###############Ё
      ########################################Ё                         Ё               Ё
      ########################################Ё                         Ё               Ё
    ддддддддддддддддддддддддддддддддддддддддддеддддддддддддддддддддддддд╢               Ё
      █═╗╛╔╜╝╒═╜╗╔ АГ╔Б═                      Ё      ┼Ю╔╓╗Б АГ╔Б═       Ё               Ё
    ддддддддддддддддддддддддддддддддддддддддддеддддддддддддддддддддддддд╢               Ё
      ########################################Ё#########################Ё               Ё
      ########################################Ё                         Ё               Ё
      ########################################Ё                         Ё               Ё
    ддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддддддддддаддддддбддддддддадддддбддддддддд
      ▒Ц╛╛═ ╞Ю╝╞╗АЛН                                                           Ё≤╗ДЮ ╓╝╙Ц╛╔╜Б═Ё   ##
      #########################################################################цддддддддддддддеддддддддд
      #########################################################################Ё              Ё
      #########################################################################цддддддддддддддеддддддддд
      #########################################################################Ё              Ё
    дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддддаддддддддд
      ▒╝╓╔Ю╕═╜╗╔ ╝╞╔Ю═Ф╗╗, ╜═╗╛╔╜╝╒═╜╗╔, ╜╝╛╔Ю ╗ ╓═Б═ ╓╝╙Ц╛╔╜Б═, ╜═ ╝А╜╝╒═╜╗╗
      ╙╝Б╝Ю╝ё╝ А╝АБ═╒╚╔╜ ╛╔╛╝Ю╗═╚Л╜К╘ ╝Ю╓╔Ю
      #################################################################################################
      #################################################################################################
      #################################################################################################
    дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
      ▐╝╓╞╗А╗        ┐╚. ║ЦЕё═╚Б╔Ю                    │ЦЕё═╚Б╔Ю
                  #########################      #########################



                  ддддддддддддддддддддддддд      ддддддддддддддддддддддддд
    дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд

               ▐Ю╗╚╝╕╔╜╗╔: ########## ╓╝╙Ц╛╔╜Б╝╒ ╜═ ##########  ╚╗АБ═Е.
                           дддддддддд               дддддддддд
 
 ]
 ( {Name_Bank}:l,
   d.Numb_Document:c,
   strDateDoc:c,
   NSP(0):l,
   d.Real_Payer:l,
   Sum:r,
   NSP(1):l,
   NSP(2):l,
   NSR(0):l,
   d.Real_Receiver:l,
   NSR(1):l,
   NSR(2):l,
   d.Shifr_oper:l,
   SS(0):l,
   SS(1):l,
   SS(2):l,
   SS(3):l,
   SG(0):l,
   SG(1):l,
   SG(2):l,
   GetFioOper({FIO_Book}, true):l,
   GetFioOper( d.Oper, true):l,
   ndoc:c,
   nsheet:c
   );
end;
end;

macro PrintOVN(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato, date_318P)
Array S,SY, Symb, SymbSum, SS, SG, SS1, SS2, NSRO, NSRK1,NSRK, NSP2, NSR2, SBP, SBR, SP, SR;
var  rc,i,ns, r_account="", data, k, n, NSP, strsum ="", pos, NSR;
NSP =  NSR  = TArray(0, 1);

   StrSplit( rubtostralt( d.Sum ), SS, 64, 81, 2 );
   StrSplit( d.Ground, SG,            81, 64, 2 );

   NSP = DoStrSplit( d.Payer,    34, 34, 3 ); // ╝Б ╙╝ё╝
   NSR = DoStrSplit( d.Receiver, 32, 32, 4 ); // ╙╝╛Ц

   StrSplit( Payer,  SP, 43, 34, 3 );
   StrSplit( Receiver, SR, 43, 34, 4 );

   StrSplit( d.Bank_Payer, SBP, 36, 36, 2 );
   StrSplit( d.Bank_Receiver, SBR, 36, 36, 2 );
   StrSplit( d.Payer, NSP2, 36, 27, 3 ); // ╝Б ╙╝ё╝
   StrSplit( d.Receiver, NSR2, 36, 24, 4 ); // ╙╝╛Ц

 S (0)="";
 SY(0)="";
 S (1)="";
 SY(1)="";
 S (2)="";
 SY(2)="";
 S (3)="";
 SY(3)="";

 if((d.Symbol_Cach ==" 0") OR (d.Symbol_Cach =="  0"))
    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;
    rc = GetGE(sc);
    ns=0;
    while(rc AND (sc.iApplicationKind == d.iApplicationKind) AND (sc.ApplicationKey == d.ApplicationKey))
      S (ns)=sc.Sum;
      SY(ns)=sc.Symbol;
      ns=ns+1;
      rc = Next(sc);
    end;
 else
   S (0)=d.Sum;
   SY(0)=d.Symbol_Cach;
   ns=1;
 end;

 if(ns<4)
   ns=4;
 end;

 if (d.Date_Document < date_318P)

[
 здддддддддддддддддддддддбдддддддбддддддддддддддддддддддддддддддддддддддддддддддддд©
 Ё      ▌│ ÷┌▀┘█┬┘  Э    Ё#######Ё                                       зддддддддд╢
 Ё   ╜═ ╒╖╜╝А ╜═╚╗Г╜К╛╗  юддддддды                                       Ё 0402001 Ё
 Ё                                                                       юддддддддд╢
 Ё    ###################                                                          Ё
 Ё   ддддддддддддддддддддд                               зддддддддддддддддддддддддд╢
 Ё▌Б ╙╝ё╝  ################################## └╚О ╖═Г╗А╚.Ё                         Ё
 Ё########################################### ╜═ АГ╔Б Э  Ё#########################Ё
 Ё###########################################            Ё                         Ё
 Ё│═╜╙ ╞╝╚ЦГ═Б╔╚О   #####################################цддддддддддддддддддддддддд╢
 Ё▐╝╚ЦГ═Б╔╚Л ################################            Ё ####################### Ё
 Ё###########################################            Ё                         Ё
 Ё###########################################            Ё     ▒Ц╛╛═ Ф╗ДЮ═╛╗       Ё
 цдддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддддддддддддддд╢
 Ё#################################################################################Ё
 Ё▒Ц╛╛═ ╞Ю╝╞╗АЛН   ################################################################Ё
 цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
 Ё┬АБ╝Г╜╗╙ ╒╖╜╝А═  ################################################################Ё
 Ё ################################################################################Ё
 цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
 Ё▐╝╓╞╗АЛ ╒╜╝А╗Б╔╚О                   │ЦЕё═╚Б╔Ю          ######################### Ё
 Ё                 дддддддддддддддддд                    ддддддддддддддддддддддддд Ё
 Ё                                    └╔╜Лё╗ ╞Ю╗╜О╚ ╙═АА╗Ю                         Ё
 Ё                                                          дддддддддддддддддддддд Ё
 цдддддддддддддддддддддддбдддддддбддддддддддддддддддддддддддддддддддддддддддддддддд╢
 Ё       ┼┌┬▓─█√┬÷  Э    Ё#######Ё                                       зддддддддд╢
 Ё                       юддддддды                                       Ё 0402001 Ё
 Ё                                                                       юддддддддд╢
 Ё      #################                                                          Ё
 Ё    ддддддддддддддддддддд                              зддддддддддддддддддддддддд╢
 Ё▌Б ╙╝ё╝  ################################## └╚О ╖═Г╗А╚.Ё                         Ё
 Ё########################################### ╜═ АГ╔Б Э  Ё#########################Ё
 Ё###########################################            Ё                         Ё
 Ё│═╜╙ ╞╝╚ЦГ═Б╔╚О   #####################################цддддддддддддддддддддддддд╢
 Ё▐╝╚ЦГ═Б╔╚Л ################################            Ё ####################### Ё
 Ё###########################################            Ё                         Ё
 Ё###########################################            Ё      ▒Ц╛╛═ Ф╗ДЮ═╛╗      Ё
 цдддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддддддддддддддд╢
 Ё#################################################################################Ё
 Ё▒Ц╛╛═ ╞Ю╝╞╗АЛН   ################################################################Ё
 цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
 Ё┬АБ╝Г╜╗╙ ╒╖╜╝А═  ################################################################Ё
 Ё#################################################################################Ё
 цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
 Ё     ▄.▐.      │ЦЕё═╚Б╔Ю               #########################                 Ё
 Ё                                       ддддддддддддддддддддддддд                 Ё
 Ё               └╔╜Лё╗ ╞Ю╗╜О╚ ╙═АА╗Ю                                              Ё
 Ё                                       ддддддддддддддддддддддддд                 Ё
 цдддддддддддддддддддддддбдддддддбддддддддддддддддддддддддддддддддддддддддддддддддд╢
 Ё            ▌░└┘░ Э    Ё#######Ё                                       зддддддддд╢
 Ё                       юддддддды                                       Ё 0402001 Ё
 Ё                                                                       юддддддддд╢
 Ё      #################                       └┘│┘▓                   ▒Ц╛╛═      Ё
 Ё                                    здддддддддддддддддддддддддбдддддддддддддддддд╢
 Ё▌Б ╙╝ё╝  ###########################Ё#########################Ё##################Ё
 Ё####################################цддддддддддддддддддддддддд╢                  Ё
 Ё####################################Ё         ┼░┘└┬▓          Ё                  Ё
 цддддддддддддддддддддддддддддддддддддеддддддддддддддддддддддддд╢                  Ё
 Ё####################################Ё                         Ё      ▌║И═О       Ё
 Ё####################################Ё                         цдддддддддддддбдддд╢
 Ё│═╜╙ ╞╝╚ЦГ═Б╔╚О                     Ё                         Ё  Г═АБ╜К╔    ЁА╗╛╒Ё
 Ёдддддддддддддддддддддддддддддддддддд╢                         цдддддддддддддедддд╢
 Ё▐╝╚ЦГ═Б╔╚Л  ########################Ё#########################Ё#############Ё####Ё
 Ё####################################Ё                         цдддддддддддддедддд╢
 Ё####################################Ё                         Ё#############Ё####Ё
 Ё####################################Ё                         цдддддддддддддедддд╢
]
(   d.Numb_Document:c,
    strDateDoc:c,
    NSR(0):l,
    NSR(1):l, d.Account_Receiver:l,
    NSR(2):l,
    d.Bank_Receiver:l,
    NSR(0):l, Sum:r,
    NSR(1):l,
    NSR(2):l,
    SS(0):l, SS(1):l,
    SG(0):l, SG(1):l,
    Buhg:l,

    d.Numb_Document:c,
    strDateDoc:c,
    NSR(0):l,
    NSR(1):l, d.Account_Receiver:l,
    NSR(2):l,
    d.Bank_Receiver:l,
    NSR(0):l, Sum:r,
    NSR(1):l,
    NSR(2):l,
    SS(0):l, SS(1):l,
    SG(0):l, SG(1):l,
    Buhg:l,

    d.Numb_Document:c,
    strDateDoc:c,
    NSR(0):l, d.Account_Payer, Sum:r ,
    NSR(1):l,
    NSR(2):l,
    SBR(0):l,
    SBR(1):l,
    NSR2(0):l, d.Account_Receiver:l, S(0):f:r,SY(0):c,
    NSR2(1):l,
    NSR2(2):l, S(1):f:r,SY(1):c,
    NSR2(3):l
);

  i=2;
  while(i<ns-1)
[Ё                                    Ё                         Ё#############Ё####Ё
 Ё                                    Ё                         цдддддддддддддедддд╢
] (S(i):f:r,SY(i):c);
  i=i+1;
  end;

[Ё                                    ЁАГ╔Б Э                   Ё#############Ё####Ё
 цддддддддддддддддддддддддддддддддддддадддддддддддддддддддддддддадддддддддддддадддд╢
 Ё┬АБ╝Г╜╗╙ ╒╖╜╝А═  ################################################################Ё
 Ё#################################################################################Ё
 Ё │ЦЕё═╚Б╔Ю                   ┼═АА╗Ю                                              Ё
 Ё #########################                                                       Ё
 Ё                                                                                 Ё
 Ё ддддддддддддддддддддддддд          дддддддддддддддддддддддд                     Ё
 юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
 
]
(
  S(ns-1):f:r,SY(ns-1):c,
  SG(0):l, SG(1):l,
  Buhg:l
);

 else  /*▌║ЙО╒╚╔╜╗╔ ╜═ ╒╖╜╝А ╜═╚╗Г╜К╛╗ ╜╝╒╝ё╝ ╝║Ю═╖Ф═ (╞╝ 318-▐)*/

    StrSplit( d.Bank_Payer, SBP, 66, 56, 2 );
    StrSplit( d.Bank_Receiver, SBR, 66, 56, 20 );
    StrSplit( d.Ground,  SG, 97, 74, 3 );
    StrSplit( SubStr(d.Receiver, 1, 160),  NSRK, 81, 73, 2 );  /* ┼╒╗Б═╜Ф╗О - ▌Б ╙╝ё╝*/
    StrSplit( SubStr(d.Receiver, 1, 160),  NSRK1, 81, 70, 3 ); /* ┼╒╗Б═╜Ф╗О - ▐╝╚ЦГ═Б╔╚Л*/
    StrSplit( SubStr(d.Receiver, 1, 160),  NSRO,  54, 42, 4);   /* ▌Ю╓╔Ю ╗ ▌║ЙО╒╚╔╜╗╔ - ▐╝╚ЦГ═Б╔╚Л*/
    NSR(0) = SubStr( d.Receiver, 1, 45);
    NSR(1) = SubStr( d.Receiver, 46, 53);
    NSR(2) = SubStr( d.Receiver, 99, 62);

    if ((IsFLAcc(d.Account_Receiver) != 1) AND (d.MFO_Receiver != ""))
        r_account = String(d.Account_Receiver);
    else
        r_account = "";
    end;

    strDateDoc =StrSubSt( strDateDoc, ".", "╝╓═");

    /* ▐Ю╔╝║Ю═╖╝╒═╜╗╔ АЦ╛╛К ╙ ╒╗╓Ц ∙∙∙ ЮЦ║. ⌠⌠ ╙╝╞. */
    strsum = rubtostralt( d.Sum );
    pos = Index( strsum, "ЮЦ║")+3;
    strsum = StrSubSt( strsum, SubStr( strsum, pos, Index( strsum, " ", pos) - pos), ".");
    strsum = StrSubSt( strsum, SubStr( strsum, Index( strsum, "╙╝╞")+3), ".");

    StrSplit( strsum, SS, 98, 58, 2 );
    StrSplit( strsum, SS1, 98, 83, 2 );
    StrSplit( strsum, SS2, 97, 53, 2 );

    i = 0;
    while ( i < 20)
        S(i) = "";
        SY(i) = "";
        i = i+1;
    end;


    if((d.Symbol_Cach ==" 0") OR (d.Symbol_Cach =="  0"))
        sc.Kind             = 1;
        sc.iApplicationKind = d.iApplicationKind;
        sc.ApplicationKey   = d.ApplicationKey;
        rc = GetGE(sc);
        i=0;
        while(rc AND (sc.iApplicationKind == d.iApplicationKind) AND (sc.ApplicationKey == d.ApplicationKey))
            S(i)=sc.Sum;
            SY(i)=sc.Symbol;
            i=i+1;
            rc = Next(sc);
        end;
    else
        S (0)=d.Sum;
        SY(0)=d.Symbol_Cach;
        i=1;
    end;

[
                                                                                                 здддддддддддддддддддд©
     ▌║ЙО╒╚╔╜╗╔ ╜═ ╒╖╜╝А ╜═╚╗Г╜К╛╗                                                               Ё     ┼╝╓ Д╝Ю╛К      Ё
                                                                                                 Ё  ╓╝╙Ц╛╔╜Б═ ╞╝ ▌┼⌠└ Ё
                    зддддддд©                                                                    цдддддддддддддддддддд╢
     ▌│ ÷┌▀┘█┬┘  Э  Ё#######Ё                                                                    Ё      0402001       Ё
                    юддддддды                                                                    юдддддддддддддддддддды
     #####################
     ддддддддддддддддддддд                                                  └┘│┘▓
                                                           зддддддддддддддддддддддддддддддддбддддддддддддддддддддддддд©
     ▌Б ╙╝ё╝ ##############################################Ё ▒Г╔Б Э ########################Ё                         Ё
     ######################################################юдддддддддддддддддддддддддддддддд╢      ################## Ё
     ##############################################################         ┼░┘└┬▓          Ё                         Ё
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддд╢       ▒Ц╛╛═ Ф╗ДЮ═╛╗     Ё
     ▐╝╚ЦГ═Б╔╚Л ###########################################Ё ▒Г╔Б Э ########################Ё                         Ё
     ######################################################юддддддддддддддддддддддддддддддддеддддддддддддддддддддддддд╢
     ######################################################                                 Ё     ╒ Б╝╛ Г╗А╚╔         Ё
     ###################################################### ┬██ ############  ┼▐▐ ######### Ё     ╞╝ А╗╛╒╝╚═╛:        Ё
     дддддддддддддддддддддддддддддддддддддддддддддддддддддд     дддддддддддд      ддддддддддеддддддддддддддддддддддддд╢
     Ю/АГ╔Б Э  #########################    ▌┼─▓▌  ###########                              Ё                         Ё
               дддддддддддддддддддддддддд          дддддддддддддддддддддддддддддддддддддддддеддддддбдддддддддддддддддд╢
     █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═-╒╜╝А╗Б╔╚О  ######################################################## ЁА╗╛╒╝╚Ё      АЦ╛╛═       Ё
     дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
     #################################################################### │┬┼ #########     Ё #####Ё##################Ё
     дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
     █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═-╞╝╚ЦГ═Б╔╚О #########################################################Ё #####Ё##################Ё
     дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
](   d.Numb_Document:c,
    strDateDoc:c,
    NSR(0):l,
    d.Account_Payer,
    NSR(1):l,
    Sum:r,
    NSR(2):l,
    NSRO(0):l,
    d.Account_Receiver,
    NSRO(1):l,
    NSRO(2):l,
    NSRO(3):l,
    inn:l, kpp:l,
    r_account:l,
    okato:l,
    SBP(0),
    SBP(1),  BIC_Payer:l,     SY(0):c,     S(0):r,
    SBR(0),  SY(1):c,         S(1):r
);

if ( S(4) != "")
    j = 0; k = 2;
    while (j < (i-4))
[    ###################################################################################### Ё #####Ё##################Ё
     дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
    ]
    (SBR(j+1),  SY(k):c,     S(k):r);
    j = j+1;
    k = k+1;
    end;
else
    k = 2;
end;

[    #################################################################### │┬┼   #########   Ё #####Ё##################Ё
     дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
     ▒Ц╛╛═ ╞Ю╝╞╗АЛН ####################################################################### Ё #####Ё##################Ё
     дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддадддддддддддддддддды
     #################################################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                                                                                        (Ф╗ДЮ═╛╗)
     ┬АБ╝Г╜╗╙ ╞╝АБЦ╞╚╔╜╗О  ###########################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     #################################################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     #################################################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     ▐╝╓╞╗АЛ ╙╚╗╔╜Б═                    │ЦЕё═╚Б╔ЮА╙╗╘ Ю═║╝Б╜╗╙            ┼═АА╝╒К╘ Ю═║╝Б╜╗╙
                                        #########################

     дддддддддддддддддд                 ддддддддддддддддддддддддд         дддддддддддддддддд

     дддддддддддддддддбдддддддбддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддд©
      ┼┌┬▓─█√┬÷  Э    Ё#######Ё                                                                Ё     ┼╝╓ Д╝Ю╛К        Ё
                      юддддддды                                                                Ё ╓╝╙Ц╛╔╜Б═ ╞╝ ▌┼⌠└    Ё
                                                                                               цдддддддддддддддддддддд╢
     #####################                                                                     Ё      0402001         Ё
     ддддддддддддддддддддд                                                                зддддадддддддддддддддддддддд╢
     ▌Б ╙╝ё╝ #############################################################################Ё  └╚О ╖═Г╗А╚╔╜╗О ╜═ АГ╔Б Э Ё
     #####################################################################################Ё                           Ё
     ▐╝╚ЦГ═Б╔╚Л ##########################################################################Ё ######################### Ё
     #####################################################################################цддддддддддддддддддддддддддд╢
     ###########################################    ┬██  ############ ┼▐▐  #########      Ё         ▒Ц╛╛═ Ф╗ДЮ═╛╗     Ё
                                                         дддддддддддд     ддддддддддд     Ё                           Ё
     Ю/АГ╔Б Э  #########################    ▌┼─▓▌  ###########                            Ё   ####################### Ё
               дддддддддддддддддддддддддд          дддддддддддддддддддддддддддддддддддддддаддддддддддддддддддддддддддды
     █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═-╒╜╝А╗Б╔╚О  ###################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     #############################################################################################     │┬┼   #########
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд           ддддддддд
     █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═-╞╝╚ЦГ═Б╔╚О  ##################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     #############################################################################################     │┬┼   #########
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд           ддддддддд
     ▒Ц╛╛═ ╞Ю╝╞╗АЛН ##################################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     #################################################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     ┬АБ╝Г╜╗╙ ╞╝АБЦ╞╚╔╜╗О  ##########################################################################  (Ф╗ДЮ═╛╗)
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     #################################################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     #################################################################################################################
     ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
     ▄╔АБ╝ ╞╔Г═Б╗       │ЦЕё═╚Б╔ЮА╙╗╘ Ю═║╝Б╜╗╙            ┼═АА╝╒К╘ Ю═║╝Б╜╗╙
      (ХБ═╛╞═)          #########################

                        ддддддддддддддддддддддддд         дддддддддддддддддд

     дддддддддддддддддбдддддддбдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддддддддддддд©
      ▌░└┘░  Э        Ё#######Ё                                                                   Ё     ┼╝╓ Д╝Ю╛К     Ё
                      юддддддды                                                                   Ё ╓╝╙Ц╛╔╜Б═ ╞╝ ▌┼⌠└ Ё
                                                                                                  цддддддддддддддддддд╢
      #####################                                                                       Ё      0402001      Ё
      ддддддддддддддддддддд                                                                       юддддддддддддддддддды
                                                                            └┘│┘▓
                                                           зддддддддддддддддддддддддддддддддбддддддддддддддддддддддддд©
      ▌Б ╙╝ё╝ #############################################Ё ▒Г╔Б Э ########################Ё                         Ё
      #####################################################юдддддддддддддддддддддддддддддддд╢  ###################### Ё
      ##############################################################       ┼░┘└┬▓           Ё                         Ё
      дддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддд╢                         Ё
      ▐╝╚ЦГ═Б╔╚Л ##########################################Ё ▒Г╔Б Э ########################Ё     ▒Ц╛╛═ Ф╗ДЮ═╛╗       Ё
      #####################################################юддддддддддддддддддддддддддддддддеддддддддддддддддддддддддд╢
      #####################################################                                 Ё     ╒ Б╝╛ Г╗А╚╔         Ё
      #####################################################  ┬██ ############ ┼▐▐ ######### Ё     ╞╝ А╗╛╒╝╚═╛:        Ё
      ддддддддддддддддддддддддддддддддддддддддддддддддддддд      дддддддддддд     ддддддддддеддддддддддддддддддддддддд╢
      Ю/АГ╔Б Э  #########################       ▌┼─▓▌    ###########                        Ё                         Ё
               дддддддддддддддддддддддддд                дддддддддддддддддддддддддддддддддддеддддддбдддддддддддддддддд╢
      █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═-╒╜╝А╗Б╔╚О  ########################################################ЁА╗╛╒╝╚Ё   АЦ╛╛═          Ё
      ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
      ##################################################################  │┬┼  #########    Ё #####Ё##################Ё
      ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
      █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═-╞╝╚ЦГ═Б╔╚О ########################################################Ё #####Ё##################Ё
      ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
](   SBR(k-1),  BIC_Receiver:l,  SY(k):c,     S(k):r,
     SS(0):l, SY(k+1):c,        S(k+1):r,
     SS(1):l,
     SG(0):l,
     SG(1):l,
     SG(2):l,
     GetFioOper(d.Oper,true):c,
     d.Numb_Document:c,
     strDateDoc:c,
     NSRK(0):l,
     NSRK(1):l,
     NSRK1(0):l,
     d.Account_Receiver,
     NSRK1(1):l,
     NSRK1(2):l,
      inn:l, kpp:l,
      r_account:l,  okato:l, Sum:r,
      SBP(0),
      SBP(1),  BIC_Payer:l,
      SBR(0),
      SBR(1),  BIC_Receiver:l,
      SS1(0):l,
      SS1(1):l,
      SG(0):l,
      SG(1):l,
     SG(2):l,
      GetFioOper(d.Oper,true):c,
      d.Numb_Document:c,
      strDateDoc:c,
     NSR(0):l,
      d.Account_Payer:l,
     NSR(1):l,
     Sum:r,
     NSR(2):l,
     NSRO(0):l,
      d.Account_Receiver:l,
     NSRO(1):l,
     NSRO(2):l,
     NSRO(3):l,
     inn:l, kpp:l,
    r_account:l,
    okato:l,
    SBP(0),
    SBP(1),  BIC_Payer:l,     SY(0):c,     S(0):r,
    SBR(0),  SY(1):c,     S(1):r
);

if ( S(4) != "")
    j = 0; k = 2;
    while (j < (i-4))
    [     ######################################################################################Ё #####Ё##################Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
    ]
    (SBR(j+1),  SY(k):c,     S(k):f:r);
    j = j+1;
    k = k+1;
    end;
else
    k = 2;
end;

[     ##############################################################     │┬┼   #########    Ё #####Ё##################Ё
      ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
      ▒Ц╛╛═ ╞Ю╝╞╗АЛН  ######################################################################Ё #####Ё##################Ё
      ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддадддддддддддддддддды
      ################################################################################################################
      дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                                                                                         (Ф╗ДЮ═╛╗)
      ┬АБ╝Г╜╗╙ ╞╝АБЦ╞╚╔╜╗О  ##########################################################################################
      дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
      ################################################################################################################
      дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
      ################################################################################################################
      дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                              │ЦЕё═╚Б╔ЮА╙╗╘ Ю═║╝Б╜╗╙            ┼═АА╝╒К╘ Ю═║╝Б╜╗╙
                              #########################

                              ддддддддддддддддддддддддд         дддддддддддддддддд
      
]
(


    SBR(k-1),  BIC_Receiver:l,  SY(k):c,     S(k):f:r,
    SS2(0):l, SY(k+1):c,     S(k+1):f:r,
    SS2(1):l,
    SG(0):l,
    SG(1):l,
    SG(2):l,
    GetFioOper(d.Oper,true):c
);
end;
end;

macro PrintRC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato, date_318P)
Array SP,SBR,SR,NSP,NSR,S,SY,SD,SBP,SS,SG;
var   rc,i,ns,doc,CodeCurr, r_account, n=0, NSRN, NSPN, SBRN, SBPN;
NSRN = NSPN = SBRN = SBPN = TArray(0, 1);

   StrSplit( rubtostralt( d.Sum ), SS, 81,66,2 );
   StrSplit( d.Ground,  SG, 81,62,2 );
   strsplit( d.Bank_Receiver,      SBR,   37,21,2 );
   strsplit( d.Payer,              NSP,   37,29,3 ); // ╝Б ╙╝ё╝
   strsplit( d.Receiver,           NSR,   37,26,4 ); // ╙╝╛Ц
   strsplit( Payer,                SP,    37,29,3 );
   strsplit( Receiver,             SR,    37,29,4 );

 S (0)="";
 SY(0)="";
 S (1)="";
 SY(1)="";

 if((d.Symbol_Cach ==" 0") OR (d.Symbol_Cach =="  0"))
     sc.Kind             = 1;
     sc.iApplicationKind = d.iApplicationKind;
     sc.ApplicationKey   = d.ApplicationKey;

     rc = GetGE(sc);
     ns=0;
     while(rc AND (sc.iApplicationKind == d.iApplicationKind) AND (sc.ApplicationKey == d.ApplicationKey))
        if ( CheckTS( sc.Symbol, LSTS_INCR ) )
           S (ns)=sc.Sum;
           SY(ns)=sc.Symbol;
           ns=ns+1;
        end;
        rc = Next(sc);
     end;
 else
    if ( CheckTS( d.Symbol_Cach, LSTS_INCR ) )
       S (0)=d.Sum;
       SY(0)=d.Symbol_Cach;
    end;
    ns=1;
 end;

 if(ns<2)
   ns=2;
 end;

 doc = GetClientDocument(d.Account_Receiver);
 strsplit( doc, SD, 81,81,2 );

 if( d.Date_Document < PR_NEWDATE ) // ╞Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю ▒▓─░▌┐▌ ╝║Ю═╖Ф═

    [

     зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
     Ё     ▐░┬∙▌└█⌡┴         зддддддд©                                                 Ё
     Ё     ┼─▒▒▌┌⌡┴ ▌░└┘░ Э  Ё#######Ё                                                 Ё
     Ё                       юддддддды                                                 Ё
     Ё   ###################                                                           Ё
     Ё  ддддддддддддддддддддд                        └╔║╔Б                  ▒Ц╛╛═      Ё
     Ё▌Б ╙╝ё╝ #############################здддддддддддддддддддддддддбддддддддддддддддд╢
     Ё#####################################Ё#########################Ё#################Ё
     Ё#####################################Ё                         Ё ▌║И═О           Ё
     цдддддддддддддддддддддддддддддддддддддедддддддддддддддддддддддддеддддддддддддбдддд╢
     Ё│═╜╙ ╞╝╚ЦГ═Б╔╚О #####################Ё     ┼Ю╔╓╗Б              Ё ≈═АБ╜К╔    Ё▒╗╛╒Ё
     Ё#####################################цдддддддддддддддддддддддддеддддддддддддедддд╢
     Ё▐╝╚ЦГ═Б╔╚Л ##########################Ё#########################Ё############Ё####Ё
     Ё#####################################Ё                         цддддддддддддедддд╢
     Ё#####################################Ё                         Ё############Ё####Ё
     Ё#####################################Ё                         цддддддддддддедддд╢
    ]
    (
      d.Numb_Document:c,
        strDateDoc:c,
        NSR(0):l,
        NSR(1):l, d.Account_Payer:l, Sum:r ,
        NSR(2):l,
        SBR(0):l, SBR(1):l,
        NSR(0):l, d.Account_Receiver:l, S(0):f:r,SY(0):c,
        NSR(1):l,
        NSR(2):l, S(1):f:r,SY(1):c,
        NSR(3):l
    );
      i=2;
      while(i<ns)
    [Ё                                     Ё                         Ё############Ё####Ё
     Ё                                     Ё                         цддддддддддддедддд╢
    ] (S(i):r,SY(i):c);
      i=i+1;
      end;

    [Ё                                     Ё                         Ё ≤╗ДЮ ╝╞╔Ю. Ё ## Ё
     цдддддддддддддддддддддддддддддддддддддадддддддддддддддддддддддддаддддддддддддадддд╢
     Ё█═╖╜═Г╔╜╗╔ ╞╚═Б╔╕═ ##############################################################Ё
     Ё#################################################################################Ё
     цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
     Ё▒Ц╛╛═ ╞Ю╝╞╗АЛН ##################################################################Ё
     Ё#################################################################################Ё
     цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
     Ё#################################################################################Ё
     Ё#################################################################################Ё
     Ё                                                                                 Ё
     Ё▐╝╓╞╗АЛ ╒╜╝А╗Б╔╚О                                                                Ё
     Ё                 ддддддддддддддддддд                                             Ё
     Ё┐╚. ║ЦЕё═╚Б╔Ю               │ЦЕё═╚Б╔Ю                         ┼═АА╗Ю             Ё
     Ё#########################   #########################                            Ё
     Ё                                                                                 Ё
     Ёддддддддддддддддддддддддд   ддддддддддддддддддддддддд         дддддддддддддддддд Ё
     юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
     
    ]
    (
       d.Shifr_Oper:c,
       SG(0):l, SG(1):l,
       SS(0):l, SS(1):l,
       SD(0):l, SD(1):l,
       GetFioOper({FIO_Book},true):l, Buhg:l
    );
  /* ╞Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю  ╞╝ 199-▐*/
  elif (d.Date_Document < date_318P)
    i = 1;
    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    if(GetEQ(sc))
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          Symb(0)    = sc.Symbol;
          SymbSum(0) = sc.Sum;
       else
          Symb(0)    = "";
          SymbSum(0) = "";
          i = 0;
       end;
    else
       if ( CheckTS( d.symbol_cach, LSTS_INCR ) )
          Symb(0)    = d.symbol_cach;
          SymbSum(0) = d.Sum;
       else
          Symb(0)    = "";
          SymbSum(0) = "";
       end;
       Symb(1)    = "";
       Symb(2)    = "";
       Symb(3)    = "";
       SymbSum(1) = "";
       SymbSum(2) = "";
       SymbSum(3) = "";
    end;

    while( next(sc)
           and (sc.Kind             == 1                  )
           and (sc.iApplicationKind == d.iApplicationKind )
           and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          Symb(i)    = sc.Symbol;
          SymbSum(i) = sc.Sum;
          i = i + 1;
       end;
    end;

    j = 0;
    while( j < 4 )
       if ( (ValType(Symb(j)) == V_UNDEF) and (ValType(SymbSum(j)) == V_UNDEF) )
          Symb(j)    = "";
          SymbSum(j) = "";
       end;
       j = j + 1;
    end;

    CodeCurr = d.Code_Currency;
    if(CodeCurr == 0)
        CodeCurr = 810;
    end;

    strsplit( d.Bank_Receiver,      SBR, 53, 53, 2 );
    strsplit( rubtostralt( d.Sum ) + " (" + CodeCurr + ")", SS, 79, 36, 3 );
    strsplit( d.Receiver,           NSR, 53, 53, 2 );
    strsplit( d.Ground,             SG,  79, 63, 2 );

    [
                                      зддддддд©
           ▐Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю Э Ё#######Ё
              ###################     юддддддды
                                                                         └┘│┘▓
                                                               зддддддддддддддддддддддддддддбдддддддддддддддддддддддд©
          ▌Б ╙╝ё╝                                              ЁАГ.Э #######################Ё                        Ё
          #####################################################Ё                            Ё ###################### Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддддддддддддд╢                        Ё
          #####################################################          ┼░┘└┬▓             Ё                        Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддд╢                        Ё
          │═╜╙ ╞╝╚ЦГ═Б╔╚О ######### ###########################ЁАГ.Э #######################Ё                        Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддд╢                            Ё                        Ё
          ▐╝╚ЦГ═Б╔╚Л ##########################################Ё                            Ё                        Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддддддддддддд╢      ▒Ц╛╛═ Ф╗ДЮ═╛╗     Ё
                                                                                            цдддддддддддддддддддддддды
          ▒Ц╛╛═ ╞Ю╝╞╗АЛН (╜═╗╛╔╜╝╒═╜╗╔ (╙╝╓) ╒═╚НБК) ####################################   Ё
                                                     ддддддддддддддддддддддддддддддддддддддд╢
          ###############################################################################   Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
          ###############################################################################   Ё╒ Б╝╛ Г╗А╚╔ ╞╝ А╗╛╒╝╚═╛:
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддддддбддддддддддд©
                                                                                            Ё  АЦ╛╛═     Ё  А╗╛╒╝╚   Ё
                                                                                            цддддддддддддеддддддддддд╢
                                                                                            Ё############Ё###########Ё
                                                                                            цддддддддддддеддддддддддд╢
                                                                                            Ё############Ё###########Ё
                                                                                            цддддддддддддеддддддддддд╢
          ┬АБ╝Г╜╗╙ ╒╖╜╝А═ ###############################################################   Ё############Ё###########Ё
                          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддддддеддддддддддд╢
          ###############################################################################   Ё############Ё###########Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддаддддддддддды

          ▐╝╓╞╗АЛ ╒╜╝А╗Б╔╚О               │ЦЕё═╚Б╔ЮА╙╗╘ Ю═║╝Б╜╗╙      ┼═АА╝╒К╘ Ю═║╝Б╜╗╙

                                        ##########################

              ▄.▐.
    
    ]
    ( d.Numb_Document:l,
      strDateDoc:c,
      d.Real_Payer,
      NSR(0),
      Sum:c,
      NSR(1),
      BIC_Receiver,
      d.bank_Receiver,
      d.Real_Receiver,
      NSR(0),
      SS(0):l,
      SS(1):l,
      SS(2):l,
      SymbSum(0):f,
      Symb(0):c,
      SymbSum(1):f,
      Symb(1):c,
      SG(0),
      SymbSum(2):f,
      Symb(2):c,
      SG(1),
      SymbSum(3):f,
      Symb(3):c,
      GetFioOper(d.Oper,true):c);
 /* ╞Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю ╞╝ 318-▐ */
 else

    StrSet(strDateDoc, strlen(strDateDoc), "╝");
    strDateDoc = strDateDoc + "╓═";

    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    i = 0;  n = 0;
    while ( i < 20)
        Symb(i) = "";
        SymbSum(i) = "";
        i = i+1;
    end;

    if(GetEQ(sc))
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          Symb(0)    = sc.Symbol;
          SymbSum(0) = sc.Sum;
          i = 1;
       else
          Symb(0)    = "";
          SymbSum(0) = "";
          i = 0;
       end;
    else
       if ( CheckTS( d.symbol_cach, LSTS_INCR ) )
          Symb(0)    = d.symbol_cach;
          SymbSum(0) = d.Sum;
          i = 1;
       else
          Symb(0)    = "";
          SymbSum(0) = "";
          i = 0;
       end;
    end;

    while( next(sc)
           and (sc.Kind             == 1                  )
           and (sc.iApplicationKind == d.iApplicationKind )
           and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          Symb(i)    = sc.Symbol;
          SymbSum(i) = sc.Sum;
          i = i + 1;
       end;
    end;

    j = 0;
    while( j < i )
       if ( (ValType(Symb(j)) == V_UNDEF) and (ValType(SymbSum(j)) == V_UNDEF) )
          Symb(j)    = "";
          SymbSum(j) = "";
       end;
       j = j + 1;
    end;

    SBRN = DoStrSplit( d.Bank_Receiver, 48, 48, 20 );
    strsplit( rubtostralt( d.Sum ), SS, 78, 31, 3 );
    NSRN = DoStrSplit( d.Receiver, 45, 45, 8);
    NSPN = DoStrSplit( d.Payer   , 45, 45, 8);
    strsplit( d.Ground,             SG,  108, 87, 2 );
    SBPN = DoStrSplit( d.Bank_Payer, 48, 48, 3 );

    if ((IsFLAcc(d.Account_Receiver) != 1) AND (d.MFO_Receiver != ""))
        r_account = String(d.Account_Receiver);
    else
        r_account = "";
    end;
   [
                                                                                                  здддддддддддддддддд©
                                                                                                  Ё    ┼╝╓ Д╝Ю╛К     Ё
                                                                                                  Ё ╓╝╙Ц╛╔╜Б═ ╞╝ ▌┼⌠└Ё
                                                                                                  цдддддддддддддддддд╢
                                                                                                  Ё     0402008      Ё
                                                                                                  юдддддддддддддддддды
                                      зддддддд©
           ▐Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю Э Ё#######Ё
              #####################   юддддддды
              ддддддддддддддддддддд
                                                                         └┘│┘▓
                                                        зддддддддддддддддддддддддддддддддбддддддддддддддддддддддддддд©
          ▌Б ╙╝ё╝                                       Ё ▒Г╔Б Э ########################Ё                           Ё
          ############################################# юдддддддддддддддддддддддддддддддд╢    ###################### Ё]
  (
      d.Numb_Document:c,
      strDateDoc:c,
      d.Account_Payer:l,
      NSPN(0):l,        Sum:r
  );


  n = 1;
  while ( (NSPN(n+2)!="") AND (n<6))
    [      #############################################                                  Ё                           Ё]( NSRN(n):l);
    n = n+1;
  end;

  [      #############################################                                  Ё                           Ё
         #############################################                  ┼░┘└┬▓          Ё                           Ё
         ддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддд╢                           Ё
         ▐╝╚ЦГ═Б╔╚Л                                    Ё ▒Г╔Б Э ########################Ё                           Ё
  ]
  (   NSPN(n):l,
      NSPN(n+1):l,
      d.Account_Receiver:l);

  if ( NSRN(3)!="" )
  [      ############################################# Ё                                Ё                           Ё
         ############################################# Ё                                Ё                           Ё
  ](    NSRN(0):l,
        NSRN(1):l);
  else
    NSRN(4) = NSRN(2);
    NSRN(2) = NSRN(0);
    NSRN(3) = NSRN(1);
  end;


  [      ############################################# цдддддддддддддддддддддддддддддддд╢         ▒Ц╛╛═ Ф╗ДЮ═╛╗     Ё
         ############################################# Ё ▒Г╔Б Э                         Ё                           Ё
         ############################################# Ё                                Ё                           Ё
  ]( NSRN(2):l,
     NSRN(3):l,
     NSRN(4):l);

  n = 5;
  while ( ( NSRN(n) != "" ) AND (n<8) )
    [      ############################################# Ё                                Ё                           Ё](NSRN(n):l);
    n=n+1;
  end;

  [      ддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддддддддддддддддддддддеддддддддддддддддддддддддддд╢
         ┬██  ############           ┼▐▐  #########          ▌┼─▓▌  ###########         Ё        ╒ Б╝╛ Г╗А╚╔        Ё
             ддддддддддддд               дддддддддд                дддддддддддд         Ё        ╞╝ А╗╛╒╝╚═╛:       Ё
         Ю/АГ╔Б Э  #########################                                            Ё                           Ё
                  ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддбдддддддддддддддддд╢
         █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═-╒╜╝А╗Б╔╚О  ################################################ Ё А╗╛╒╝╚ Ё   АЦ╛╛═          Ё
  ]
  ( inn:l,  kpp:l,  okato:l,
    r_account:l,
    SBPN(0):l);

  n = 1;
  while ( (ValType (SBPN(n+1)) != V_UNDEF) AND ( SBPN(n+1) != "") AND ( SBPN(n+1) != " ") )
  [      ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢        Ё                  Ё
         ############################################################################## Ё        Ё                  Ё
  ]( SBPN(n):l);
  n = n+1;
  end;

  [      дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддд╢
         ##########################################################     │┬┼   ######### Ё  ##### Ё##################Ё
         дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддд╢
         █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═-╞╝╚ЦГ═Б╔╚О ################################################ Ё  ##### Ё##################Ё
         дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддд╢
   ]
   (
      SBPN(n):l,  BIC_Payer:l,     Symb(0):c,     SymbSum(0):f:r,
      SBRN(0):l,  Symb(1):c,       SymbSum(1):f:r
   );



   if ( (Symb(2) == "") OR ((Symb(2) != "") and (Symb(3) == "")) )
    [      ############################################################################## Ё  ##### Ё##################Ё
           дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддд╢
    ]
    (SBRN(1):l,  Symb(2):c,       SymbSum(2):f:r);
    j = 3;
    if  ( (ValType (SBRN(3)) != V_UNDEF) AND ( SBRN(3) != "") AND ( SBRN(3) != " ") )
       [      ############################################################################## Ё  ##### Ё##################Ё
              дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддд╢
       ] (SBRN(2):l,  "", "");
       j = 4;
    end;
   else
        j = 2;
        while ( j< i-1 )
            [      ############################################################################## Ё  ##### Ё##################Ё
                   дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддд╢
            ]
            (SBRN(j-1):l,  Symb(j):c,       SymbSum(j):f:r);
            j = j+1;
        end;
   end;



   [      ###########################################################    │┬┼   ######### Ё  ##### Ё##################Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддедддддддддддддддддд╢
          ▒Ц╛╛═ ╞Ю╝╞╗АЛН А Ц╙═╖═╜╗╔╛ ╜═╗╛╔╜╝╒═╜╗О ╒═╚НБК ############################### Ё  ##### Ё##################Ё
                                                         ддддддддддддддддддддддддддддддддаддддддддадддддддддддддддддды
          ############################################################################################################
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
          ############################################################################################################
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
          ┬АБ╝Г╜╗╙ ╞╝АБЦ╞╚╔╜╗О #######################################################################################
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
          ############################################################################################################
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд

          ▐╝╓╞╗АЛ ╒╜╝А╗Б╔╚О               │ЦЕё═╚Б╔ЮА╙╗╘ Ю═║╝Б╜╗╙                   ┼═АА╝╒К╘ Ю═║╝Б╜╗╙
                                          ##########################


          дддддддддддддддддддддд          ддддддддддддддддддддддддддд              дддддддддддддддддддддд
    
    ]
    (
      SBRN(j-1):l,      BIC_Receiver:l,    Symb(j):c,        SymbSum(j):f:r,
      SS(0):l,         Symb(j+1):c,       SymbSum(j+1):f:r,
      SS(1):l,
      SS(2):l,
      SG(0):l,
      SG(1):l,
      GetFioOper(d.Oper,true):c
    );
 end;
end;

macro PrintOC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, date_318P)
Array SS,SP,SBR,SR,SG,NSP,NSR,S,SY,SD, Symb, SymbSum;
var  rc,i,ns,doc,CodeCurr, nameDoc = "", numbDoc = "", placeDoc = "", dateDoc = "", strDoc1 = "", strDoc2 = "", n, NSPN = TArray(0, 1), SBRN = TArray(0, 1);


   strsplit( rubtostralt( d.Sum ), SS,    81,66,2 );
   strsplit( d.Ground,             SG,    43,62,3 );
   strsplit( d.Bank_Receiver,      SBR,   37,37,2 );
   strsplit( d.Payer,              NSP,   38,30,3 ); // ╝Б ╙╝ё╝
   strsplit( d.Receiver,           NSR,   38,30,4 ); // ╙╝╛Ц
   strsplit( Payer,                SP,    38,30,3 );
   strsplit( Receiver,             SR,    38,30,4 );

 S (0)="";
 SY(0)="";
 S (1)="";
 SY(1)="";
 if((d.Symbol_Cach ==" 0") OR (d.Symbol_Cach =="  0"))
     sc.Kind             = 1;
     sc.iApplicationKind = d.iApplicationKind;
     sc.ApplicationKey   = d.ApplicationKey;

     rc = GetGE(sc);
     ns=0;
     while(rc AND (sc.iApplicationKind == d.iApplicationKind) AND (sc.ApplicationKey == d.ApplicationKey))
        if ( CheckTS( sc.Symbol, LSTS_DECR ) )
           S (ns)=sc.Sum;
           SY(ns)=sc.Symbol;
           ns=ns+1;
        end;
        rc = Next(sc);
     end;
 else
    if ( CheckTS( d.Symbol_Cach, LSTS_DECR ) )
       S (0)=d.Sum;
       SY(0)=d.Symbol_Cach;
    end;
    ns=1;
 end;

 if(ns<2)
   ns=2;
 end;

 doc = GetClientDocument(d.Account_Payer);
 strsplit( doc, SD, 81, 81, 2 );

 if( d.Date_Document < PR_NEWDATE ) // Ю═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю ▒▓─░▌┐▌ ╝║Ю═╖Ф═

    [
     здддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддбддддддддддддддддд©
     Ё     ░─▒∙▌└█⌡┴                       Ё        ╛╔АБ╝  ╓╚О       Ё                 Ё
     Ё     ┼─▒▒▌┌⌡┴ ▌░└┘░ Э #######        Ё         ╜═╙╚╔╘╙╗        Ё    Э #######    Ё
     Ё                                     Ё          Б═╚╝╜═         Ё  Б═╚╝╜ ╒ ╙═ААЦ  Ё
     Ё   ###################               Ё                         Ё                 Ё
     Ё  ддддддддддддддддддддд              цдддддддддддддддддддддддддеддддддддддддддддд╢
     Ё┌К╓═БЛ ##############################Ё          └╔║╔Б          Ё     ▒Ц╛╛═       Ё
     Ё#####################################Ё#########################Ё#################Ё
     Ё#####################################Ё                         Ё                 Ё
     Ё                                     цддддддддддддддддддддддддд╢                 Ё
     Ё                                     Ё          ┼Ю╔╓╗Б         Ё                 Ё
     Ё#####################################Ё                         цддддддддддддбдддд╢
     Ё█═╗╛╔╜╝╒═╜╗╔ ║═╜╙═                   Ё#########################Ё ≈═АБ╜К╔    Ё▒╗╛╒Ё
     цдддддддддддддддддддддддддддддддддддддадддддддддддддддддддддддддеддддддддддддедддд╢
     Ё█═╖╜═Г╔╜╗╔ ╞╚═Б╔╕═ ########################################### Ё############Ё####Ё
     Ё############################################################## цддддддддддддедддд╢
     Ё                                                               Ё############Ё####Ё
     Ё                                                               цддддддддддддедддд╢
    ]
    (
      d.Numb_Document:c,d.Numb_Document:c,
        strDateDoc:c,
        NSP(0):l,
        NSP(1):l, d.Account_Payer:l, Sum:r ,
        NSP(2):l,
        d.Bank_Receiver, d.Account_Receiver:l,
        SG(0),  S(0):r,SY(0):c,
        SG(1),  S(1):r,SY(1):c
    );
      i = 2;
      while( i < ns )
    [Ё                                                               Ё############Ё####Ё
     Ё                                                               цддддддддддддедддд╢
    ] (S(i):r,SY(i):c);
      i = i + 1;
      end;

    [Ё                                                               Ё ≤╗ДЮ ╝╞╔Ю. Ё ## Ё
     цдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддадддд╢
     Ё▒Ц╛╛═ ╞Ю╝╞╗АЛН ##################################################################Ё
     Ё#################################################################################Ё
     цддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
     Ё#################################################################################Ё
     Ё#################################################################################Ё
     Ё                                                                                 Ё
     Ё⌠╙═╖═╜╜ЦН ╒ ╝Ю╓╔Ю╔ АЦ╛╛Ц ╞╝╚ЦГ╗╚                                                 Ё
     Ё                                 ддддддддддддддддддддддддддддддд                 Ё
     Ё┐╚. ║ЦЕё═╚Б╔Ю                  │ЦЕё═╚Б╔Ю                      ┼═АА╗Ю             Ё
     Ё#########################   #########################                            Ё
     Ё                                                                                 Ё
     Ёддддддддддддддддддддддддд   ддддддддддддддддддддддддд         дддддддддддддддддд Ё
     юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
     
    ]
    (
       d.Shifr_Oper:c,
       SS(0):l, SS(1):l,
       SD(0):l, SD(1):l,
       GetFioOper({FIO_Book},true):l, Buhg:l

    );
 elif (d.Date_Document < date_318P) // Ю═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю  ╝║Ю═╖Ф═ (199-▐)
    i = 1;
    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    if(GetEQ(sc))
        if ( CheckTS( sc.Symbol, LSTS_DECR ) )
           Symb(0)    = sc.Symbol;
           SymbSum(0) = sc.Sum;
        else
           Symb(0)    = "";
           SymbSum(0) = "";
           i = 0;
        end;
    else
        if ( CheckTS( d.Symbol_Cach, LSTS_DECR ) )
           Symb(0)    = d.symbol_cach;
           SymbSum(0) = d.Sum;
        else
           Symb(0)    = "";
           SymbSum(0) = "";
        end;
        Symb(1)    = "";
        Symb(2)    = "";
        Symb(3)    = "";
        SymbSum(1) = "";
        SymbSum(2) = "";
        SymbSum(3) = "";
    end;

    While(next(sc)
         and (sc.Kind             == 1                  )
         and (sc.iApplicationKind == d.iApplicationKind )
         and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_DECR ) )
          Symb(i)    = sc.Symbol;
          SymbSum(i) = sc.Sum;
          i = i + 1;
       end;
    end;

    j = 0;
    While( j < 4 )
       if ((ValType(Symb(j)) == V_UNDEF) and (ValType(SymbSum(j)) == V_UNDEF))
          Symb(j)="";
          SymbSum(j)="";
       end;
       j = j + 1;
    end;

    CodeCurr = d.code_currency;

    if(CodeCurr == 0)
        CodeCurr = 810;
    end;

    strsplit( d.Payer,              NSP,   53,  46,  3 );
    strsplit( rubtostralt( d.Sum ) + " (" + CodeCurr + ")", SS, 79, 30, 3 );
    strsplit( d.Ground,             SG,    69,  50,  4 );

    SetDocParm( acc, d.Account_Payer, d.Code_Currency, @nameDoc, @numbDoc, @placeDoc, @dateDoc );

    [
                                      зддддддд©                                   ▄┘▒▓▌ └▀÷
           ░═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю Э Ё#######Ё                                █─┼▀┘┴┼┬ ▓─▀▌█─
                                      юддддддды
              ###################                                        └┘│┘▓
                                                               зддддддддддддддддддддддддддддбдддддддддддддддддддддддд©
                                                               ЁАГ.Э #######################Ё Э Б═╚╝╜═               Ё
          ┌К╓═БЛ ##############################################Ё                            Ё ╒ ╙═ААЦ                Ё
                 ддддддддддддддддддддддддддддддддддддддддддддддадддддддддддддддддддддддддддд╢                        Ё
          #####################################################          ┼░┘└┬▓             Ё #                      Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддддддддддддддддддддддедддддддддддддддддддддддд╢
          #####################################################ЁАГ.Э #######################Ё ###################### Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддд╢                            Ё                        Ё
          #####################################################Ё                            Ё                        Ё
                                           зддддддддддддддддддд╢                            Ё                        Ё
          █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═               Ё │┬┼  #########    Ё                            Ё     ▒Ц╛╛═ Ф╗ДЮ═╛╗      Ё
          дддддддддддддддддддддддддддддддддадддддддддддддддддддаддддддддддддддддддддддддддддедддддддддддддддддддддддды
          █═╖╜═Г╔╜╗╔ ╞╚═Б╔╕═                                                                Ё
                             ##################################################             Ё╒ Б╝╛ Г╗А╚╔ ╞╝ А╗╛╒╝╚═╛:
                             дддддддддддддддддддддддддддддддддддддддддддддддддд             цддддддддддддбддддддддддд©
          #####################################################################             Ё   АЦ╛╛═    Ё  А╗╛╒╝╚   Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд             цддддддддддддеддддддддддд╢
          #####################################################################             Ё############Ё###########Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд             цддддддддддддеддддддддддд╢
          #####################################################################             Ё############Ё###########Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддддддддеддддддддддд╢
          ▒Ц╛╛═ ╞Ю╝╞╗АЛН (╜═╗╛╔╜╝╒═╜╗╔ (╙╝╓) ╒═╚НБК) ####################################   Ё############Ё###########Ё
                                                     дддддддддддддддддддддддддддддддддддддддеддддддддддддеддддддддддд╢
          ###############################################################################   Ё############Ё###########Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддаддддддддддды

          ▐Ю╔╓ЙО╒╚╔╜ ╓╝╙Ц╛╔╜Б, Ц╓╝АБ╝╒╔ЮОНИ╗╘ ╚╗Г╜╝АБЛ ####################################, Э ####################
                                                      ддддддддддддддддддддддддддддддддддддд    дддддддддддддддддддд
          ┌К╓═╜ ################################################################### ########## ё.
                ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд дддддддддд
          ⌠╙═╖═╜╜ЦН ╒ ╝Ю╓╔Ю╔ АЦ╛╛Ц ╞╝╚ЦГ╗╚
                                               ______________________
                                                (╞╝╓╞╗АЛ ╞╝╚ЦГ═Б╔╚О)

          ┼╝╜БЮ╝╚╗ЮЦНИ╗╘ Ю═║╝Б╜╗╙                   │ЦЕё═╚Б╔ЮА╙╗╘ Ю═║╝Б╜╗╙                      ┼═АА╝╒К╘ Ю═║╝Б╜╗╙

                                                   ########################

    
    ]
    ( d.Numb_Document:l,
      strDateDoc:c,
      d.Real_Payer,
      NSP(0),
      NSP(1),
      d.Numb_Document:l,
      NSP(2),
      d.Real_Receiver,
      Sum:r,
      d.Bank_Receiver,
      BIC_receiver,
      SG(0),
      SG(1),
      SG(2),
      SymbSum(0),
      Symb(0):c,
      SG(3),
      SymbSum(1),
      Symb(1):c,
      SS(0):l,
      SymbSum(2),
      Symb(2):c,
      SS(1):l,
      SymbSum(3),
      Symb(3):c,
      nameDoc:l, numbDoc:l,
      placeDoc:l, dateDoc:l,
      GetFioOper(d.Oper,true):c );
 /* Ю═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю ╞╝ 318-▐*/
 else

    StrSet(strDateDoc, strlen(strDateDoc), "╝");
    strDateDoc = strDateDoc + "╓═";

    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    i = 0;
    while ( i < 50)
        Symb(i) = "";
        SymbSum(i) = "";
        i = i+1;
    end;

    if(GetEQ(sc))
        if ( CheckTS( sc.Symbol, LSTS_DECR ) )
           Symb(0)    = sc.Symbol;
           SymbSum(0) = sc.Sum;
           i = 1;
        else
           Symb(0)    = "";
           SymbSum(0) = "";
           i = 0;
        end;
    else
        if ( CheckTS( d.Symbol_Cach, LSTS_DECR ) )
           Symb(0)    = d.symbol_cach;
           SymbSum(0) = d.Sum;
           i = 1;
        else
           Symb(0)    = "";
           SymbSum(0) = "";
           i = 0;
        end;

    end;

    While(next(sc)
         and (sc.Kind             == 1                  )
         and (sc.iApplicationKind == d.iApplicationKind )
         and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_DECR ) )
          Symb(i)    = sc.Symbol;
          SymbSum(i) = sc.Sum;
          i = i + 1;
       end;
    end;

    j = 0;
    While( j < i )
       if ((ValType(Symb(j)) == V_UNDEF) and (ValType(SymbSum(j)) == V_UNDEF))
          Symb(j)="";
          SymbSum(j)="";
       end;
       j = j + 1;
    end;


    NSPN = DoStrSplit( d.Payer, 50, 50, 7 );
    strsplit( d.Ground,             SG,    79,  60,  20 );
    SBRN = DoStrSplit( d.Bank_Receiver, 32, 32, 10 );
    strsplit( rubtostralt( d.Sum ), SS,    81,32,2 );

    SetDocParm( acc, d.Account_Payer, d.Code_Currency, @nameDoc, @numbDoc, @placeDoc, @dateDoc );

    if (nameDoc != "")
        strDoc1 = "▐Ю╔╓ЙО╒╚╔╜ ╓╝╙Ц╛╔╜Б, Ц╓╝АБ╝╒╔ЮОНИ╗╘ ╚╗Г╜╝АБЛ:" + " " + nameDoc + " Э " + numbDoc;
        strDoc2 = "┌К╓═╜" + " " + placeDoc + " " + dateDoc;
    end;

    [
                                                                                                   здддддддддддддддддд©
                                                                                                   Ё    ┼╝╓ Д╝Ю╛К     Ё
                                                                                                   Ё ╓╝╙Ц╛╔╜Б═ ╞╝ ▌┼⌠└Ё
                                                                                                   цдддддддддддддддддд╢
                                                                                                   Ё     0402009      Ё
                                                                                                   юдддддддддддддддддды

                                                                                            зд д д д д д д д д д д д д©
                                      зддддддд©                                                   ▌БЮК╒╜╝╘ Б═╚╝╜
           ░═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю Э Ё#######Ё                                             Ё  ╙ Ю═АЕ╝╓╜╝╛Ц ╙═АА╝╒╝╛Ц Ё
                                      юддддддды                                                  ╝Ю╓╔ЮЦ Э #######
             #####################                                                          Ё             ддддддд     Ё
             ддддддддддддддддддддд                                                          юд д д д д д д д д д д д  ы

                                                                         └┘│┘▓              зддддддддддддддддддддддддд©
                                                             здддддддддддддддддддддддддддддд╢   ▄╔АБ╝ ╓╚О ╜═╙╚╔╘╙╗    Ё
          ┌К╓═БЛ                                             Ё▒Г╔Б Э #######################Ё   ╝БЮК╒╜╝ё╝ Б═╚╝╜═      Ё
          ###################################################юддддддддддддддддддддддддддддддеддддддддддддддддддддддддд╢
          ###################################################                               Ё                         Ё
          ###################################################                               Ё                         Ё
    ]( d.Numb_Document:c,
       d.Numb_Document:c,
       strDateDoc:c,
       d.Account_Payer,
       NSPN(0),
       NSPN(1),
       NSPN(2));

    n = 3;
    while ((NSPN(n+1)!="") AND (n<6))
    [     ###################################################                               Ё                         Ё]( NSPN(n):l);
      n = n+1;
    end;

    [     ###################################################            ┼░┘└┬▓             Ё ######################  Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддд╢                         Ё
          █═╗╛╔╜╝╒═╜╗╔ ║═╜╙═ ################################Ё▒Г╔Б Э #######################Ё      ▒Ц╛╛═ Ф╗ДЮ═╛╗      Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддаддддддддддддддддддддддддддддддеддддддддддддддддддддддддд╢
    ]( NSPN(n),
       Sum:c,
       SBRN(0),
       d.Account_Receiver);

    n = 1;
    while ( SBRN(n+1) != "" )
    [     ################################################################################# Ё                         Ё
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢                         Ё
    ] ( SBRN(n));
    n = n+1;
    end;


    [     ###############################################################   │┬┼  #########  Ё     ╒ Б╝╛ Г╗А╚╔         Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд       дддддддддддд╢     ╞╝ А╗╛╒╝╚═╛:        Ё
          ▒Ц╛╛═ ╞Ю╝╞╗АЛН А Ц╙═╖═╜╗╔╛ ╜═╗╛╔╜╝╒═╜╗О ╒═╚НБК ################################   Ё                         Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддбдддддддддддддддддд╢
          ###############################################################################   ЁА╗╛╒╝╚Ё     АЦ╛╛═        Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
          █═╞Ю═╒╚╔╜╗╔ ╒К╓═Г╗ ############################################################   Ё #### Ё##################Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢
    ]
   (  SBRN(n),
      BIC_Receiver,
      SS(0):l,
      SS(1):l,
      SG(0),
      Symb(0):c,
      SymbSum(0):f:r
    );


    if ( (Symb(1) == "") OR ( (Symb(1) != "") AND (Symb(2) == "") ) OR  ( (Symb(1) != "") AND (Symb(2) != "") AND ((Symb(3) == ""))))
    [     ################################################################################  Ё #### Ё##################Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢]
    (
      SG(1),
      Symb(1):c,
      SymbSum(1):f:r
    );
    j = 2;
    else
        j = 1;
        while ( j< i-1 )
        [     ################################################################################  Ё #### Ё##################Ё
              ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддеддддддедддддддддддддддддд╢]
        (
            SG(j),
            Symb(j):c,
            SymbSum(j):f:r
        );
        j = j+1;
        end;
    end;

    [     ################################################################################  Ё #### Ё##################Ё
          ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддаддддддадддддддддддддддддды
          #########################################################################################################
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                                                           (╜═╗╛╔╜╝╒═╜╗╔ ╓╝╙Ц╛╔╜Б═)
          #########################################################################################################
          дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                                                                      (╙╔╛ ╒К╓═╜)
          ⌠╙═╖═╜╜ЦН ╒ Ю═АЕ╝╓╜╝╛ ╙═АА╝╒╝╛ ╝Ю╓╔Ю╔ АЦ╛╛Ц ╞╝╚ЦГ╗╚
                                                                ______________________
                                                                  (╚╗Г╜═О ╞╝╓╞╗АЛ)

          │ЦЕё═╚Б╔ЮА╙╗╘ Ю═║╝Б╜╗╙                    ┼╝╜БЮ╝╚╔Ю                  ┼═АА╝╒К╘ Ю═║╝Б╜╗╙
          ########################

          ________________________            ________________________       ________________________
    
    ]
    (
      SG(j),
      Symb(j):c,
      SymbSum(j):f:r,
      strDoc1,
      strDoc2:l,
      GetFioOper(d.Oper,true):c );
 end;

end;


/*                   ▐Ю╗Е╝╓╜╝ - Ю═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    */
macro PrintORC(strDateDoc,Sum, StrPayDate,kind_doc)
Array SSP,SGR,SGP,S,SY,SD, SSR, SymbP, SymbSumP, SymbR, SymbSumR;
var  rc,i,k,ns,doc, nameDoc = "", numbDoc = "", placeDoc = "", dateDoc = "", strDoc1 = "", strDoc2 = "",pos,payer, BuhP, BuhR, Name_vn = "", str="",
     PNumbDoc, RNumbDoc, PayerP, PayerR, ReceiverP, ReceiverR, PBank_Pay, RBank_Pay, RBank_Rec, PBank_rec, Pdate, Rdate, Psum, Rsum, NamePayer, NameReceiver ;
var cl  = TBFile("client.dbt", "R", 0, "client.dbt", "bank.def"), val = TArray(0, 1), NM = TArray(0, 1), NM1 = TArray(0, 1), NM2 = TArray(0, 1);
  
   strsplit( rubtostralt( d.Sum ), SSP,   42,27,20 );
   strsplit( rubtostralt( d.Sum ), SSR,   41,26,20 );
   strsplit( d.Ground,             SGP,   52,42,2 );
   strsplit( d.Ground,             SGR,   51,41,2 );
   
   if (d.MFO_Receiver == "")   /* ╞╝╚ЦГ╗БЛ ╗╜╗Ф╗═╚К ╓╚О ёЮ═ДК ┌╜╝А╗Б╔╚Л*/
     ClearRecord(cl);
     cl.Rec.Name_client = d.Receiver;
     cl.keynum = 10;
     if ( cl.GetEQ() and (cl.Rec.LegalForm == "2"))
        Name_vn = cl.Rec.szShortName;
     end;
   end;

   StrSet(strDateDoc, strlen(strDateDoc), "╝");
   strDateDoc = strDateDoc + "╓═";

   //add George S.Polyakov 30.06.2010
   
   pos=index(d.Payer,"╞═А╞.");
   
   if (pos==0)
     Payer=d.Payer;
     strDoc2="";
   else
     Payer=SubStr(d.Payer,1,pos-2);
     strDoc2="╞═А╞╝ЮБ ░■ Э "+SubStr(d.Payer,pos+6);
   end;
   strsplit(strDoc2,SD,64,64,2);
   //add George S.Polyakov 30.06.2010
   
   if (Name_vn == "")
    Name_vn = Payer;
   end;

   NM = DoStrSplit( Name_vn, 25, 25, 13);

   

/*
   SetDocParm( acc, d.Account_Payer, d.Code_Currency, @nameDoc, @numbDoc, @placeDoc, @dateDoc );

    if (nameDoc != "")
        strDoc1 = nameDoc + " Э " + numbDoc;
        strDoc2 = "┌К╓═╜" + " " + placeDoc + " " + dateDoc;
        strDoc1 = String(strDoc1:52);
        strDoc2 = string(strDoc2:52);
    end;
*/
    /*   ┼═АА╝╒К╔ А╗╛╒╝╚К  */
    i = 0;
    while ( i < 20)
        SymbR(i) = "";
        SymbSumR(i) = "";
        SymbP(i) = "";
        SymbSumP(i) = "";
        i = i+1;
    end;

    i = 0; k = 1;
    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    if(GetEQ(sc))
        if ( CheckTS( sc.Symbol, LSTS_DECR ) )
           SymbR(0)    = sc.Symbol;
           SymbSumR(0) = sc.Sum;
        else
           SymbR(0)    = "";
           SymbSumR(0) = "";
        end;
        if ( CheckTS( sc.Symbol, LSTS_INCR ) )
           SymbP(0)    = sc.Symbol;
           SymbSumP(0) = sc.Sum;
        else
           SymbP(0)    = "";
           SymbSumP(0) = "";
        end;
    else
        if ( CheckTS( d.Symbol_Cach, LSTS_DECR ) )
           SymbR(0)    = d.symbol_cach;
           SymbSumR(0) = d.Sum;
        else
           SymbR(0)    = "";
           SymbSumR(0) = "";
        end;
        if ( CheckTS( d.Symbol_Cach, LSTS_INCR ) )
           SymbP(0)    = d.symbol_cach;
           SymbSumP(0) = d.Sum;
        else
           SymbP(0)    = "";
           SymbSumP(0) = "";
        end;

    end;

    While(next(sc)
         and (sc.Kind             == 1                  )
         and (sc.iApplicationKind == d.iApplicationKind )
         and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_DECR ) )
          SymbR(i)    = sc.Symbol;
          SymbSumR(i) = sc.Sum;
          i = i + 1;
       end;
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          SymbP(k)    = sc.Symbol;
          SymbSumP(k) = sc.Sum;
          k = k + 1;
       end;
    end;

    j = 0;
    While( j < i )
       if ((ValType(SymbP(j)) == V_UNDEF) and (ValType(SymbSumP(j)) == V_UNDEF))
          SymbP(j)="";
          SymbSumP(j)="";
       end;
       j = j + 1;
    end;

    j = 0;
    While( j < k )
       if ((ValType(SymbR(j)) == V_UNDEF) and (ValType(SymbSumR(j)) == V_UNDEF))
          SymbR(j)="";
          SymbSumR(j)="";
       end;
       j = j + 1;
    end;


   RNumbDoc = d.Numb_Document;
   PNumbDoc = d.Numb_Document;
   Pdate = StrDateDoc;
   Rdate = StrDateDoc;
   NameReceiver = d.Receiver;
   NamePayer = Payer;
   PBank_Pay = d.Bank_Payer;
   RBank_Pay = PBank_Pay;
   RBank_Rec = d.Bank_Receiver;
   PBank_Rec = RBank_Rec;
   PSum = string(d.Sum:a);
   PSum = StrSubSt( PSum, ".", "-");
   RSum = Psum;
   PayerP = d.Account_Payer;
   PayerR = PayerP;
   ReceiverP = d.Account_Receiver;
   ReceiverR  = ReceiverP;
   BuhP = GetFioOper(d.Oper,true);
   BuhR = BuhP;

   NM1 = DoStrSplit( NameReceiver, 44, 44, 12);
   NM2 = DoStrSplit( NamePayer,    44, 44, 12);
   //add George S.Polyakov 30.06.2010
   NM1 = strsplit2(NamePayer,56,true,12);

   if ( kind_doc == 1) /*║Ц╓╔Б ╖═╞╝╚╜ОБЛАО Б╝╚Л╙╝ ╞Ю╗Е╝╓╜═О Г═АБЛ */
        RNumbDoc = "";
        Rdate = "";
        NamePayer = "";
        PayerR = "";
        RBank_Pay = "";
        RBank_Rec = "";
        Rsum = "";
        ReceiverR = "";
        BuhR = "";
        strsplit( "", SSR,   31, 16, 50 );
        strsplit( "", SGR,   51, 41, 5 );
        j = 0;
        while ( j < 20)
            SymbR(j) = "";
            SymbSumR(j) = "";
            j = j+1;
         end;
        strDoc1 = ""; strDoc2 = "";
        j=0;
        while ( j<12 )
            NM2(j)="";
            j=j+1;
       end;
   elif ( kind_doc == 2) /*║Ц╓╔Б ╖═╞╝╚╜ОБЛАО Б╝╚Л╙╝ Ю═АЕ╝╓╜═О Г═АБЛ */
        PNumbDoc = "";
        Pdate = "";
        NameReceiver = "";
        PayerP = "";
        PBank_Pay = "";
        PBank_Rec = "";
        Psum = "";
        ReceiverP = "";
        BuhP = "";
        strsplit( "", SSP,   32, 17, 50 );
        strsplit( "", SGP,   52, 42, 5 );
        j = 0;
        while ( j < 20)
            SymbP(j) = "";
            SymbSumP(j) = "";
            j = j+1;
         end;
        j=0;
        while ( j<12 )
            NM1(j) = "";
            NM(j)="";
            j=j+1;
       end;
 end;
   [&l0S&l1O&a8L&k2S&l0E&l8D
                                                                                                                            зддддддддддддддддддд©
                                                                                                                            Ё     ┼╝╓ Д╝Ю╛К     Ё
                                                                                                                            Ё ╓╝╙Ц╛╔╜Б═ ╞╝ ▌┼⌠└ Ё
                                                                                                                            цддддддддддддддддддд╢
                                                                                                                            Ё      0402007      Ё
                                                                                                                            юддддддддддддддддддды
                                               зддддддд©                    Ё                                               зддддддд©
           ▐Ю╗Е╝╓╜╝-Ю═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю Э Ё#######Ё                    Ё           ▐Ю╗Е╝╓╜╝-Ю═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю Э Ё#######Ё
                                               юддддддды                    Ё                                               юддддддды
           #####################                                            Ё           #####################
           ддддддддддддддддддддд                                            Ё           ддддддддддддддддддддд
           ▐░┬∙▌└█─÷ ≈─▒▓°                                                  Ё           ░─▒∙▌└█─÷ ≈─▒▓°
                                                                            Ё
           ▌Б ╙╝ё╝ #########################################################Ё           ┌К╓═БЛ #########################################################
   ]
   (
           PNumbDoc:c,      RNumbDoc:c,
           Pdate:c,         Rdate:c,
           NM1(0):c,  NM2(0):c
   );

      i=1;
      while(i<12)
        if ( (NM1(i)!="") OR (NM2(i)!="") )
   [               #########################################################Ё                  #########################################################] (NM1(i), NM2(i));
        else
            break;
        end;
      i=i+1;
      end;


   [       ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддде           ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                               (Д═╛╗╚╗О, ╗╛О, ╝БГ╔АБ╒╝)                     Ё                                 (Д═╛╗╚╗О, ╗╛О, ╝БГ╔АБ╒╝)
           │═╜╙-╝Б╞Ю═╒╗Б╔╚Л ################################################Ё           │═╜╙-╞╝╚ЦГ═Б╔╚Л ################################################
           ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддде           ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
           │═╜╙-╞╝╚ЦГ═Б╔╚Л #################################################Ё           │═╜╙-╝Б╞Ю═╒╗Б╔╚Л ###############################################
           ддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддде           дддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддд©
                                                     Ё   ▒Ц╛╛═ Ф╗ДЮ═╛╗      Ё                                                    Ё     ▒Ц╛╛═ Ф╗ДЮ═╛╗    Ё
                              └┘│┘▓                  Ё #####################Ё                           └┘│┘▓                    Ё #####################Ё
           здддддддддддддддддддддддддддддддддддддддддедддддддддддддддддддддд╢           зддддддддддддддддддддддддддддддддддддддддедддддддддддддддддддддд╢
           Ё    ▒Г╔Б Э ##############################Ё    ╒ Б╝╛ Г╗А╚╔       Ё           Ё    ▒Г╔Б Э #############################Ё    ╒ Б╝╛ Г╗А╚╔       Ё
           юддддддддддддддддддддддддддддддддддддддддд╢    ╞╝ А╗╛╒╝╚═╛:      Ё           юдддддддддддддддддддддддддддддддддддддддд╢    ╞╝ А╗╛╒╝╚═╛:      Ё
                              ┼░┘└┬▓                 Ё                      Ё                           ┼░┘└┬▓                   Ё                      Ё
           здддддддддддддддддддддддддддддддддддддддддеддддддбддддддддддддддд╢           зддддддддддддддддддддддддддддддддддддддддеддддддбддддддддддддддд╢
           Ё    ▒Г╔Б Э ##############################ЁА╗╛╒╝╚Ё     АЦ╛╛═     Ё           Ё    ▒Г╔Б Э #############################ЁА╗╛╒╝╚Ё     АЦ╛╛═     Ё
           юдддддддддддддддддддддддддддддддддддддддддеддддддеддддддддддддддд╢           юддддддддддддддддддддддддддддддддддддддддеддддддеддддддддддддддд╢
           ▒Ц╛╛═ ╞Ю╝╞╗АЛН ###########################Ё #### Ё###############Ё           ▒Ц╛╛═ ╞Ю╝╞╗АЛН ##########################Ё #### Ё###############Ё
           ддддддддддддддддддддддддддддддддддддддддддеддддддеддддддддддддддд╢           дддддддддддддддддддддддддддддддддддддддддеддддддеддддддддддддддд╢
   ]
   (
           PBank_Pay:l,     RBank_Rec:l,
           PBank_Rec:l,     RBank_Pay:l,
           PSum:r,          RSum:r,
           PayerP:l,        PayerR:l,
           ReceiverP:l,     ReceiverR:l,
           SSP(0):l,        SymbP(0):c,      SymbSumP(0):f:r,    SSR(0):l,          SymbR(0):c,      SymbSumR(0):f:r
   );


        [       ##########################################Ё #### Ё###############Ё           #########################################Ё #### Ё###############Ё
                ддддддддддддддддддддддддддддддддддддддддддеддддддеддддддддддддддд╢           дддддддддддддддддддддддддддддддддддддддддеддддддеддддддддддддддд╢
        ]
        (SSP(1):l,        SymbP(1):c,      SymbSumP(1):f:r,    SSR(1):l,          SymbR(1):c,      SymbSumR(1):f:r);
        j = 2;
        while ( (SymbP(j+1) != "") OR  (SymbR(j+1) != ""))
        [       ##########################################Ё #### Ё###############Ё           #########################################Ё #### Ё###############Ё
                ддддддддддддддддддддддддддддддддддддддддддеддддддеддддддддддддддд╢           дддддддддддддддддддддддддддддддддддддддддеддддддеддддддддддддддд╢
        ]
        (SSP(j):l,        SymbP(j):c,      SymbSumP(j):f:r,    SSR(j):l,          SymbR(j):c,      SymbSumR(j):f:r);
        j = j+1;
        end;

   [       ##########################################Ё #### Ё###############Ё           #########################################Ё #### Ё###############Ё
           ддддддддддддддддддддддддддддддддддддддддддаддддддаддддддддддддддд╢           дддддддддддддддддддддддддддддддддддддддддаддддддаддддддддддддддды
           ▌А╜╝╒═╜╗╔ #######################################################Ё           ▌А╜╝╒═╜╗╔ #######################################################
                     дддддддддддддддддддддддддддддддддддддддддддддддддддддддЁ           ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
           #################################################################Ё           #################################################################
           дддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддЁ           ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
           ┌╜╝А╗Б╔╚Л                            ############################Ё           │ЦЕё═╚Б╔ЮА╙╗╘                 ###################################
    ] (
           SSP(j):l,        SymbP(j):c,      SymbSumP(j):f:r,    SSR(j):l,          SymbR(j):c,      SymbSumR(j):f:r,
           SGP(0):l,        SGR(0):l,
           SGP(1):l,        SGR(1):l,
           NM(0):l,         BuhR:c
      );

        i=1;
        while ( (NM(i) != "") AND ( i<13 ) )
   [                                  ######################################Ё] (NM(i));
             i=i+1;
        end;



   [                            ддддддддддддддд ддддддддддддддддддддддддддддЁ           Ю═║╝Б╜╗╙     ддддддддддддддд  ддддддддддддддддддддддддддддддддддд
                                (╚╗Г╜═О ╞╝╓╞╗АЛ)    (Д═╛╗╚╗О ╗ ╗╜╗Ф╗═╚К)    Ё                        (╚╗Г╜═О ╞╝╓╞╗АЛ)       (Д═╛╗╚╗О ╗ ╗╜╗Ф╗═╚К)
                                                                            Ё
           │ЦЕё═╚Б╔ЮА╙╗╘                ####################################Ё           ┼╝╜БЮ╝╚╔Ю
           Ю═║╝Б╜╗╙      дддддддддддддд ддддддддддддддддддддддддддддддддддддЁ                        ддддддддддддддд  ддддддддддддддддддддддддддддддддддд
                         (╚╗Г╜═О ╞╝╓╞╗АЛ)     (Д═╛╗╚╗О ╗ ╗╜╗Ф╗═╚К)          Ё                        (╚╗Г╜═О ╞╝╓╞╗АЛ)       (Д═╛╗╚╗О ╗ ╗╜╗Ф╗═╚К)
                                                                            Ё
           ▐╝╚ЦГ╗╚ ╙═АА╝╒К╘                                                 Ё           ▐╝╚ЦГ╗╚ ╞╝ ╓╝╙Ц╛╔╜БЦ, Ц╓╝АБ╝╒╔ЮОНИ╔╛Ц ╚╗Г╜╝АБЛ,
           Ю═║╝Б╜╗╙                                                         Ё           #################################################################
                          дддддддддддддд  ддддддддддддддддддддддддддддддддддЁ           ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                         (╚╗Г╜═О ╞╝╓╞╗АЛ)     (Д═╛╗╚╗О ╗ ╗╜╗Ф╗═╚К)          Ё           #################################################################
                                                                            Ё           ддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд
                                                                            Ё           (╜═╗╛╔╜╝╒═╜╗╔ ╓╝╙Ц╛╔╜Б═, ╜╝╛╔Ю, ╙╔╛ ╗ ╙╝ё╓═ ╒К╓═╜)
                                                                            Ё
                                                                            Ё           ┌К╓═╚ ╙═АА╝╒К╘
                                                                            Ё           Ю═║╝Б╜╗╙        ддддддддддддд  дддддддддддддддддддддддддддддддддд
                                                                            Ё                         (╚╗Г╜═О ╞╝╓╞╗АЛ)        (Д═╛╗╚╗О ╗ ╗╜╗Ф╗═╚К)
   
   ]
   (
    BuhP:c,
    SD(0):l,
    SD(1):l
   );
end;

 macro PutPlat ( ptr, NumbCopy, action, repname, sf)

  Var   Payer,
        Receiver,
        BIC_Payer,
        CorAcc_Payer,
        BIC_Receiver,
        CorAcc_Receiver,
        dateDoc,DayDateDoc,
        strDateDoc,
        SumStr,  Sum = "",
        StrPayDate,
        inn, kpp, inn_kpp, BS,
        cp, Buhg,it,stat,menu_name,
        mask_ocp, err, Num_p = 0, NumDel = 0,
        okato="",
        cl  = TBFile("client.dbt", "R", 0, "client.dbt", "bank.def"), val = TArray(0, 1), date_318P, data, it1;

  var ac = TBFile("account.dbt", "R", 0, "account.dbt", "bank.def"), client, countSheet =  GlobalReport.GetCountSheet(), ndoc = 1, nsheet = 1, ctgarr = TArray( 0, 1);
  array menu_item, menu_items;
  record ind (arhdoc, "bank.def");

  if ( action == 3 )
       GlobalReport.SetCurSheet( 0 );
       while( Num_p < GlobalReport.GetCountSheet() )
          if ( GlobalReport.GetCurSheet.GetArrPrintStr().size == 0 )
             GlobalReport.SetExecute( string("iBook.Sheets.Item("+ String( Num_p + 1 - NumDel )+").Delete") );
             NumDel = NumDel + 1;
             if ( (Num_p + 1) == countSheet ) /*  #111072   */
                if ( Num_p > 0 )
                   Num_p = Num_p - 1;
                end;
                GlobalReport.SetCurSheet( Num_p);
                break;
             end;
          end;
          Num_p = Num_p + 1;
          if ( Num_p < GlobalReport.GetCountSheet() )
            GlobalReport.SetZoomType(ZOOM_TYPE_A4,1,Num_p);
            GlobalReport.SetCurSheet( Num_p );
          end;
       end;
       GlobalReport.SetExecute( "iSheet=iBook.Sheets.Item(1)" );
  end;

   stat = SetParmPlat( NumbCopy, action, repname );
   if ( (stat != 2) AND (stat != 0) )
       return 0;
   end;

  if (┼╝╚╗Г╔АБ╒╝┼╝╞╗╘ == 0)
    if ( not GetInt(┼╝╚╗Г╔АБ╒╝┼╝╞╗╘,"┌╒╔╓╗Б╔ ╙╝╚╗Г╔АБ╒╝ ╙╝╞╗╘.",3))
      exit(1);
    end;
  end;

  setbuff( ind, ptr );
  if ( not ┬А╙╚НГ╗БЛ▌┌▐(ind, d) )

      if   ( GetIdentProgram == 129 )   /*  129 - ▄┌▌└│  */
          exit(1);
      elif ( GetIdentProgram == 142 ) /*  142 - ▌БГ╔БК │═╜╙═  */
          return;
      end;
  end;

  it=-1;
  it1 = -1;

  DocToInn( d, 0, 0, inn, kpp );
   inn_kpp = "";

   if ( inn > "" )
      inn_kpp = "┬██ " + inn + " ";
      if ( kpp > "" )
         inn_kpp = inn_kpp + "┼▐▐ " + kpp + " ";
      end;
   end;

  Payer = inn_kpp + d.Payer;

  DocToInn( d, 0, 1, inn, kpp );
   inn_kpp = "";
   if ( inn > "" )
      inn_kpp = "┬██ " + inn + " ";
      if ( kpp > "" )
         inn_kpp = inn_kpp + "┼▐▐ " + kpp + " ";
      end;
   end;

  Receiver = inn_kpp + d.Receiver;

  /*▌┼─▓▌*/
  if( (d.MFO_Receiver == "") AND (d.MFO_Payer == "")  )
  ClearRecord(ac);
  ac.Rec.Account = d.Account_Receiver;
  if ( ac.GetEQ())
    client = ac.Rec.Client;
  end;
  end;
  if ( client)
        if ( GetCtgVal( 3, 335, GetClientID(client), val ) )
            okato = SubStr(val[0], 1, 11);
        end;
    end;

   if( d.MFO_Payer == "" )
      BIC_Payer = {MFO_Bank};
      CorAcc_Payer = {CORAC_Bank};
   else
      BIC_Payer = d.MFO_Payer;
      CorAcc_Payer = d.CorAcc_Receiver;
   end;

   if( d.MFO_Receiver == "" )
      BIC_Receiver = {MFO_Bank};
      CorAcc_Receiver = {CORAC_Bank};
   else
      BIC_Receiver = d.MFO_Receiver;
      CorAcc_Receiver = d.CorAcc_Receiver;
   end;

   if( d.SaveAutoKey > 0 )
      dateDoc = d.Date_Carry;    /* ─ЮЕ╗╒╜К╘ ╓╝╙Ц╛╔╜Б */
   else
      dateDoc = d.Date_Document; /* └╝╙Ц╛╔╜Б Б╔╙ЦИ╔ё╝ ╓╜О */
   end;

   if(sf AND (dateDoc>{curdate}))
     dateDoc={curdate};
   end;

   strDateDoc = String(dateDoc:f:m);
  // Sumstr = ▒Ц╛╛═√╗ДЮ═╛╗(d.Sum);

  Sum = string( d.Sum:a);
  Sum = StrSubSt( Sum, ".", "-");

   if(d.Pay_Date != ZeroDate)
    StrPayDate = PutDatePoint(d.Pay_Date);
   else
    StrPayDate = "";
   end;

   GetRegistryValue("MVODB\\└▌┼⌠▄┘█▓⌡\\└─▓─ 318▐", V_STRING, date_318P, err );
   data = Date(date_318P);

   if ( GetCtgVal( 1, 149, MakeDocumentId( d.iApplicationKind, d.ApplicationKey), ctgarr ) )
        ndoc = ctgarr(0);
   end;

   if ( GetCtgVal( 1, 150, MakeDocumentId( d.iApplicationKind, d.ApplicationKey), ctgarr ) )
        nsheet = ctgarr(0);
   end;

 BS = SubStr(d.Account_Payer,1,3);
 Buhg = GetFioOper(d.Oper,true);
 menu_name = "┌К║╔Ю╗Б╔ Д╝Ю╛Ц ╓╚О ╞╔Г═Б╗ ╓╝╙Ц╛╔╜Б═ "+string(d.Numb_Document);
 while(NumbCopy>0)
  if(PrintUNFFlag==false)
  if( (Trim(d.Kind_Oper) == "3") AND (d.Shifr_Oper != "16"))

      if( ( BS == "202" ) AND ( SubStr(d.Account_Receiver,1,3) == "202" ) )
      /* ▒≈┘▓ └┘│┘▓─ ┬ ┼░┘└┬▓─ ▐░┬█─└▀┘├┬▓ 202 */

          menu_item(0)="    ▄╔╛╝Ю╗═╚Л╜К╘ ╝Ю╓╔Ю          ";
          menu_item(1)="    ▐Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
          menu_item(2)="    ░═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
          menu_item(3)="    ▐Ю╗Е╝╓╜╝-Ю═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
          if(it<0)
             it = Menu(menu_item,null,menu_name);
             if(it <0)
               exit(1);
             end;
          end;
          if   ( it == 0 )
          /* ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ */
             PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
          elif ( it == 1 )
          /* ▐░┬∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
             PrintRC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato, data);
          elif ( it == 2 )
          /* ░─▒∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
             PrintOC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
          elif ( it == 3 )
          /* ▐░┬∙▌└█▌ - ░─▒∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
             menu_items(0)="    ▐Ю╗Е╝╓╜═О ╗ Ю═АЕ╝╓╜═О Г═АБ╗ ";
             menu_items(1)="    ▐Ю╗Е╝╓╜═О Г═АБЛ    ";
             menu_items(2)="    ░═АЕ╝╓╜═О Г═АБЛ    ";
             if(it1<0)
                it1 = Menu(menu_items,null,menu_name);
                if(it1 <0)
                    exit(1);
                end;
             end;

             PrintORC( strDateDoc, Sum, StrPayDate, it1 );
          end;

      elif( BS == "202" )
      /* ▒≈┘▓ └┘│┘▓─ ▐░┬█─└▀┘├┬▓ 202 */

          if( d.Shifr_Oper == "04" )
            /*▌│ ÷┌▀┘█┬┘ █─ ┌┤█▌▒ █─▀┬≈█⌡▄┬*/
            PrintOVN(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato, data);
          else
             GetRegistryValue("REPORT\\OCP\\OCP_1", V_STRING, mask_ocp, err );
             if ( (err != REG_OK) )
                mask_ocp = "▌┌▐";
             end;
             ClearRecord( acc );
             keynum( acc, 0 );
             acc.Account = d.Account_Receiver;
             if ( GetEQ(acc) AND (mask_ocp != "") AND ( CompareStrWithMasks(mask_ocp, acc.Balance) == 0 ) )
                /* │─▀─█▒▌┌⌡┴ ▒≈┘▓─ ┼░┘└┬▓─ ▌▐┬▒─█ ┌ REPORT\\OCP\\OCP_1 */
                asize( menu_item, 0 );
                menu_item(0)="    ▄╔╛╝Ю╗═╚Л╜К╘ ╝Ю╓╔Ю          ";
                menu_item(1)="    ▐Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
                it = Menu(menu_item,null,menu_name);
                if(it <0)
                  exit(1);
                end;
                if ( it == 0 )
                   /* ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ */
                   PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
                else
                   /*▐░┬∙▌└█⌡┴ ┼─▒▒▌┌⌡┴*/
                   PrintRC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
                end;
             else
                /*▐░┬∙▌└█⌡┴ ┼─▒▒▌┌⌡┴*/
                PrintRC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
             end;
          end;

      elif( SubStr(d.Account_Receiver,1,3) == "202" )
      /* ▒≈┘▓ ┼░┘└┬▓─ ▐░┬█─└▀┘├┬▓ 202 */

         GetRegistryValue("REPORT\\OCP\\OCP_1", V_STRING, mask_ocp, err );
         if ( (err != REG_OK) )
            mask_ocp = "▌┌▐";
         end;
         ClearRecord( acc );
         keynum( acc, 0 );
         acc.Account = d.Account_Payer;
         if ( GetEQ(acc) AND (mask_ocp != "") AND ( CompareStrWithMasks(mask_ocp, acc.Balance) == 0 ) )
            /* │─▀─█▒▌┌⌡┴ ▒≈┘▓─ └┘│┘▓─ ▌▐┬▒─█ ┌ REPORT\\OCP\\OCP_1 */
            asize( menu_item, 0 );
            menu_item(0)="    ▄╔╛╝Ю╗═╚Л╜К╘ ╝Ю╓╔Ю          ";
            menu_item(1)="    ░═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
            it = Menu(menu_item,null,menu_name);
            if(it <0)
              exit(1);
            end;
            if ( it == 0 )
               /* ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ */
               PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
            else
               /*░─▒∙▌└█⌡┴ ┼─▒▒▌┌⌡┴*/
               PrintOC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
            end;
         else
            /*░─▒∙▌└█⌡┴ ┼─▒▒▌┌⌡┴*/
            PrintOC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
         end;

      else
      /* ╜╗ Б╝, ╜╗ Б╝ ╜╗Г╔╛Ц ╜╔ ╞Ю╗╜═╓╚╔╕╗Б */

         /* ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ */
         PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, ndoc, nsheet);
      end;

  else
    PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, ndoc, nsheet);
  end;

  else

  if( (Trim(d.Kind_Oper) == "3") AND (d.Shifr_Oper != "16"))

      if( ( BS == "202" ) AND ( SubStr(d.Account_Receiver,1,3) == "202" ) )
      /* ▒≈┘▓ └┘│┘▓─ ┬ ┼░┘└┬▓─ ▐░┬█─└▀┘├┬▓ 202 */

          menu_item(0)="    ▄╔╛╝Ю╗═╚Л╜К╘ ╝Ю╓╔Ю          ";
          menu_item(1)="    ▐Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
          menu_item(2)="    ░═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
          menu_item(3)="    ▐Ю╗Е╝╓╜╝-Ю═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
          if(it<0)
             it = Menu(menu_item,null,menu_name);
             if(it <0)
               exit(1);
             end;
          end;
          if   ( it == 0 )
          /* ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ */
             PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
          elif ( it == 1 )
          /* ▐░┬∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
             PrintReportRP(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
          elif ( it == 2 )
          /* ░─▒∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
             PrintReportRR(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
          elif ( it == 3 )
          /* ▐░┬∙▌└█▌ - ░─▒∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
             menu_items(0)="    ▐Ю╗Е╝╓╜═О ╗ Ю═АЕ╝╓╜═О Г═АБ╗ ";
             menu_items(1)="    ▐Ю╗Е╝╓╜═О Г═АБЛ    ";
             menu_items(2)="    ░═АЕ╝╓╜═О Г═АБЛ    ";
             if(it1<0)
                it1 = Menu(menu_items,null,menu_name);
                if(it1 <0)
                    exit(1);
                end;
             end;

             PrintReportRPR(d, strDateDoc, Sum, StrPayDate, it1);

          end;

      elif( BS == "202" )
      /* ▒≈┘▓ └┘│┘▓─ ▐░┬█─└▀┘├┬▓ 202 */

          if( d.Shifr_Oper == "04" )
            /*▌│ ÷┌▀┘█┬┘ █─ ┌┤█▌▒ █─▀┬≈█⌡▄┬*/
            PrintOVN(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp,  okato, data);
            SetOutput( repname, false);
            PrintReportROV(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp,  okato, data);
            SetOutput( null, true);
          else
             GetRegistryValue("REPORT\\OCP\\OCP_1", V_STRING, mask_ocp, err );
             if ( (err != REG_OK) )
                mask_ocp = "▌┌▐";
             end;
             ClearRecord( acc );
             keynum( acc, 0 );
             acc.Account = d.Account_Receiver;
             if ( GetEQ(acc) AND (mask_ocp != "") AND ( CompareStrWithMasks(mask_ocp, acc.Balance) == 0 ) )
                /* │─▀─█▒▌┌⌡┴ ▒≈┘▓─ ┼░┘└┬▓─ ▌▐┬▒─█ ┌ REPORT\\OCP\\OCP_1 */
                asize( menu_item, 0 );
                menu_item(0)="    ▄╔╛╝Ю╗═╚Л╜К╘ ╝Ю╓╔Ю          ";
                menu_item(1)="    ▐Ю╗Е╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
                it = Menu(menu_item,null,menu_name);
                if(it <0)
                  exit(1);
                end;
                if ( it == 0 )
                   /* ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ */
                   PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
                else
                   /* ▐░┬∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
                   PrintReportRP(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
                end;
             else
                /*▐░┬∙▌└█⌡┴ ┼─▒▒▌┌⌡┴*/
                PrintReportRP(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
             end;
          end;

      elif( SubStr(d.Account_Receiver,1,3) == "202" )
      /* ▒≈┘▓ ┼░┘└┬▓─ ▐░┬█─└▀┘├┬▓ 202 */

         GetRegistryValue("REPORT\\OCP\\OCP_1", V_STRING, mask_ocp, err );
         if ( (err != REG_OK) )
            mask_ocp = "▌┌▐";
         end;
         ClearRecord( acc );
         keynum( acc, 0 );
         acc.Account = d.Account_Payer;
         if ( GetEQ(acc) AND (mask_ocp != "") AND ( CompareStrWithMasks(mask_ocp, acc.Balance) == 0 ) )
            /* │─▀─█▒▌┌⌡┴ ▒≈┘▓─ └┘│┘▓─ ▌▐┬▒─█ ┌ REPORT\\OCP\\OCP_1 */
            asize( menu_item, 0 );
            menu_item(0)="    ▄╔╛╝Ю╗═╚Л╜К╘ ╝Ю╓╔Ю          ";
            menu_item(1)="    ░═АЕ╝╓╜К╘ ╙═АА╝╒К╘ ╝Ю╓╔Ю    ";
            it = Menu(menu_item,null,menu_name);
            if(it <0)
              exit(1);
            end;
            if ( it == 0 )
               /* ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ */
               PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
            else
               /* ░─▒∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
               PrintReportRR(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,  data);
            end;
         else
            /* ░─▒∙▌└█⌡┴ ┼─▒▒▌┌⌡┴ */
            PrintReportRR(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
         end;

      else
      /* ╜╗ Б╝, ╜╗ Б╝ ╜╗Г╔╛Ц ╜╔ ╞Ю╗╜═╓╚╔╕╗Б */

         /* ▄┘▄▌░┬─▀°█⌡┴ ▌░└┘░ */
         PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
      end;

  else
    PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
  end;
  end;
  NumbCopy=NumbCopy-1;
  end;

  if(action==0)
     if(NumbCopy > 1)
        GlobalReport.PrintRepCopy(NumbCopy-1);
        println("");
     end;
     SetParmPlat( NumbCopy, 3, repname );
  end;

  end;

 macro PutPlatMO ( ptr, NumbCopy, action, repname, sf)
    PutPlat ( ptr, NumbCopy, action, repname, sf);
 end;