/*-RSL----------------------------------------------------JV R-Style--*/
/*--------------- ¥ç âì ¬¥¬®à¨ «ì­®£® ®à¤¥à  ------------------------*/
 import plcommon,plcomrep;
 import brkstr, bankinter, vrslplat, i2order, fncommon, fm_all;

 record d (arhdoc  , "bank.def");
 FILE pers(person  , "bank.def");
 FILE sc  (symbcash, "bank.def");
 FILE cl  (client  , "bank.def");
 FILE clf (claddfrm, "bank.def");
 FILE acc (account , "bank.def");

 private array Symb, SymbSum;
 private var j;

/* ----------------------------------------------------- */
/* ‚ë¢®¤ ¤ âë ç¥à¥§ â®çªã   */
macro PutDatePoint( dat )
    Var Day, Mon, Year;
   datesplit( dat, Day, Mon, Year );
   return LZ(Day,2) + "." + LZ(Mon,2) + "." + LZ(Year,4);
end;

/* ----------------------------------------------------- */

macro PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, ndoc, nsheet)

var n, Ground="", , sumtostr="", SP, SR, SBR, SBP, NSP, NSR, SG, SS;
SP = SR = SBP = SBR = NSP = NSR = SG = SS = TArray(0, 1) ;

if ( d.Date_Document < {Date2161U} )

   SS  = DoStrSplit( rubtostralt( d.Sum ), 76,76,2 );
   SG  = DoStrSplit( d.Ground,        67, 67, 3 );
   SBP = DoStrSplit( d.Bank_Payer,    43, 43, 2 );
   SBR = DoStrSplit( d.Bank_Receiver, 43, 43, 2 );
   SP  = DoStrSplit( Payer,           43, 43, 10);
   SR  = DoStrSplit( Receiver,        43, 43, 10);
[

  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  ³    Œ…Œˆ€‹œ›‰ „… N  ³ ############### ³ #######################    ”®à¬  N 0401108 ³
  ³                          ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                    ³
  ³                                                     /„ â /                              ³
  ÃÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
  ³ ‘ã¬¬     ³ ############################################################################ ³
  ³ ¯à®¯¨áìî ³ ############################################################################ ³
  ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
  ³ ########################################### ³  ‘ã¬¬    ³ ############################   ³
  ³ ########################################### ³          ³                                ³]
    ( d.Numb_Document:c,
       strDateDoc:c,
       SS(0), SS(1),
       SP(0), Sum:r,
       SP(1));

    n = 2;
    while ( ( n<9 ) AND ( SP(n+1)!="") )
[ ³ ########################################### ³          ³                                ³]( SP(n));
    n = n+1;
    end;

[ ³ ########################################### ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
  ³ « â¥«ìé¨ª                                  ³  ‘ç.N    ³ #########################      ³
  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄ´                                ³
  ³ ########################################### ³  ˆŠ     ³ #################              ³
  ³ ########################################### ÃÄÄÄÄÄÄÄÄÄÄ´                                ³
  ³  ­ª ¯« â¥«ìé¨ª                             ³  ‘ç.N    ³ #########################      ³
  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
  ³ ########################################### ³  ˆŠ     ³ #################              ³
  ³ ########################################### ÃÄÄÄÄÄÄÄÄÄÄ´                                ³
  ³  ­ª ¯®«ãç â¥«ï                             ³  ‘ç.N    ³ #########################      ³
  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄ´                                ³
  ³ ########################################### ³  ‘ç.N    ³ #########################      ³
  ³ ########################################### ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ´
  ³ ########################################### ³ ˜¨äà.¤®ª.³ ###### ³‘à®ª ¯« â.³            ³
  ³ ########################################### ÃÄÄÄÄÄÄÄÄÄÄ´        ÃÄÄÄÄÄÄÄÄÄÄ´            ³
  ³ ########################################### ³ §­.¯« â.³        ³ç¥à.¯« â.³ ###        ³]
  ( SP(n), d.Real_Payer,
       SBP(0), BIC_Payer,
       SBP(1), CorAcc_Payer,
       SBR(0), BIC_Receiver,
       SBR(1), CorAcc_Receiver,
       SR(0),  d.Real_Receiver,
       SR(1), SR(2), d.Shifr_oper,
       SR(3),
       SR(4), d.Payment);

     n = 5;
     while ( ( SR(n)!="") AND (n<10) )
         [ ³ ########################################### ³          ³        ³          ³            ³]( SR(n));
     n = n+1;
     end;


[ ³                                             ³          ³        ³          ³            ³
  ³ ®«ãç â¥«ì                                  ³   Š®¤    ³        ³¥§.¯®«¥  ³            ³
  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄ´
  ³  §­ ç¥­¨¥ ¯« â¥¦   ################################################################### ³
  ³ ####################################################################################### ³
  ³ ####################################################################################### ³
  ³                                                                                         ³
  ³                              ®¤¯¨á¨                                                    ³
  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
  
    ] ( SG(0), SG(1), SG(2) );
elif ( d.Date_Document >= {Date2161U} )
 sumtostr =  rubtostralt( d.Sum );
 sumtostr = StrSubSt( sumtostr, SubStr( sumtostr, Index( sumtostr, "ª®¯")+3), ".");
 SS =  DoStrSplit( sumtostr, 72, 72, 4);
 NSP = DoStrSplit( GetNameAc( d.Real_Payer, 1, 0 ), 40, 40, 3);
 NSR = DoStrSplit( GetNameAc( d.Real_Receiver, 1, 0), 40, 40, 3);

 strDateDoc =StrSubSt( strDateDoc, ".", "®¤ ");

 Ground = d.Ground+ " N " + d.Numb_Document + " ®â " + strDateDoc;
 SG = DoStrsplit( Ground,97, 97, 3 );

 Sum = string( d.Sum);
 if ( index(Sum,".00" ))
    Sum = StrSubSt( Sum, ".00", "=");
 else
    Sum = StrSubSt( Sum, ".", "-");
 end;

 [
                                                                                    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                                                                                    ³  Š®¤ ä®à¬ë     ³
                                                                                    ³  ¤®ªã¬¥­â  ¯®  ³
                                                                                    ³  Š“„          ³
                                                                                    ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
                                                                                    ³   0401108      ³
                                                                                    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

      ###############################################################################################
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ‘®áâ ¢¨â¥«ì

      Œ…Œˆ€‹œ›‰ „… N   ###############            #######################
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                                „ â 

    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
       ¨¬¥­®¢ ­¨¥ áç¥â                       ³      „¥¡¥â áç¥â         ³‘ã¬¬  æ¨äà ¬¨
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ########################################³#########################³###############³
      ########################################³                         ³               ³
      ########################################³                         ³               ³
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´               ³
       ¨¬¥­®¢ ­¨¥ áç¥â                       ³      Šà¥¤¨â áç¥â        ³               ³
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´               ³
      ########################################³#########################³               ³
      ########################################³                         ³               ³
      ########################################³                         ³               ³
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÁÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄ
      ‘ã¬¬  ¯à®¯¨áìî                                                           ³˜¨äà ¤®ªã¬¥­â ³   ##
      #########################################################################ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄ
      #########################################################################³              ³
      #########################################################################ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄ
      #########################################################################³              ³
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄ
      ‘®¤¥à¦ ­¨¥ ®¯¥à æ¨¨, ­ ¨¬¥­®¢ ­¨¥, ­®¬¥à ¨ ¤ â  ¤®ªã¬¥­â , ­  ®á­®¢ ­¨¨
      ª®â®à®£® á®áâ ¢«¥­ ¬¥¬®à¨ «ì­ë© ®à¤¥à
      #################################################################################################
      #################################################################################################
      #################################################################################################
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ®¤¯¨á¨        ƒ«. ¡ãå£ «â¥à                    ãå£ «â¥à
                  #########################      #########################



                  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

               à¨«®¦¥­¨¥: ########## ¤®ªã¬¥­â®¢ ­  ##########  «¨áâ å.
                           ÄÄÄÄÄÄÄÄÄÄ               ÄÄÄÄÄÄÄÄÄÄ
 
 ]
 ( {Name_Bank}:l,
   d.Numb_Document:c,
   strDateDoc:c,
   NSP(0):l,
   d.Real_Payer:l,
   Sum:r,
   NSP(1):l,
   NSP(2):l,
   NSR(0):l,
   d.Real_Receiver:l,
   NSR(1):l,
   NSR(2):l,
   d.Shifr_oper:l,
   SS(0):l,
   SS(1):l,
   SS(2):l,
   SS(3):l,
   SG(0):l,
   SG(1):l,
   SG(2):l,
   GetFioOper({FIO_Book}, true):l,
   GetFioOper( d.Oper, true):l,
   ndoc:c,
   nsheet:c
   );
end;
end;

macro PrintOVN(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato, date_318P)
Array S,SY, Symb, SymbSum, SS, SG, SS1, SS2, NSRO, NSRK1,NSRK, NSP2, NSR2, SBP, SBR, SP, SR;
var  rc,i,ns, r_account="", data, k, n, NSP, strsum ="", pos, NSR;
NSP =  NSR  = TArray(0, 1);

   StrSplit( rubtostralt( d.Sum ), SS, 64, 81, 2 );
   StrSplit( d.Ground, SG,            81, 64, 2 );

   NSP = DoStrSplit( d.Payer,    34, 34, 3 ); // ®â ª®£®
   NSR = DoStrSplit( d.Receiver, 32, 32, 4 ); // ª®¬ã

   StrSplit( Payer,  SP, 43, 34, 3 );
   StrSplit( Receiver, SR, 43, 34, 4 );

   StrSplit( d.Bank_Payer, SBP, 36, 36, 2 );
   StrSplit( d.Bank_Receiver, SBR, 36, 36, 2 );
   StrSplit( d.Payer, NSP2, 36, 27, 3 ); // ®â ª®£®
   StrSplit( d.Receiver, NSR2, 36, 24, 4 ); // ª®¬ã

 S (0)="";
 SY(0)="";
 S (1)="";
 SY(1)="";
 S (2)="";
 SY(2)="";
 S (3)="";
 SY(3)="";

 if((d.Symbol_Cach ==" 0") OR (d.Symbol_Cach =="  0"))
    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;
    rc = GetGE(sc);
    ns=0;
    while(rc AND (sc.iApplicationKind == d.iApplicationKind) AND (sc.ApplicationKey == d.ApplicationKey))
      S (ns)=sc.Sum;
      SY(ns)=sc.Symbol;
      ns=ns+1;
      rc = Next(sc);
    end;
 else
   S (0)=d.Sum;
   SY(0)=d.Symbol_Cach;
   ns=1;
 end;

 if(ns<4)
   ns=4;
 end;

 if (d.Date_Document < date_318P)

[
 ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³      šŸ‚‹…ˆ…  ü    ³#######³                                       ÚÄÄÄÄÄÄÄÄÄ´
 ³   ­  ¢§­®á ­ «¨ç­ë¬¨  ÀÄÄÄÄÄÄÄÙ                                       ³ 0402001 ³
 ³                                                                       ÀÄÄÄÄÄÄÄÄÄ´
 ³    ###################                                                          ³
 ³   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                               ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³â ª®£®  ################################## „«ï § ç¨á«.³                         ³
 ³########################################### ­  áç¥â ü  ³#########################³
 ³###########################################            ³                         ³
 ³ ­ª ¯®«ãç â¥«ï   #####################################ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³®«ãç â¥«ì ################################            ³ ####################### ³
 ³###########################################            ³                         ³
 ³###########################################            ³     ‘ã¬¬  æ¨äà ¬¨       ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³#################################################################################³
 ³‘ã¬¬  ¯à®¯¨áìî   ################################################################³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³ˆáâ®ç­¨ª ¢§­®á   ################################################################³
 ³ ################################################################################³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³®¤¯¨áì ¢­®á¨â¥«ï                   ãå£ «â¥à          ######################### ³
 ³                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ³
 ³                                    „¥­ì£¨ ¯à¨­ï« ª áá¨à                         ³
 ³                                                          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³       Š‚ˆ’€–ˆŸ  ü    ³#######³                                       ÚÄÄÄÄÄÄÄÄÄ´
 ³                       ÀÄÄÄÄÄÄÄÙ                                       ³ 0402001 ³
 ³                                                                       ÀÄÄÄÄÄÄÄÄÄ´
 ³      #################                                                          ³
 ³    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                              ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³â ª®£®  ################################## „«ï § ç¨á«.³                         ³
 ³########################################### ­  áç¥â ü  ³#########################³
 ³###########################################            ³                         ³
 ³ ­ª ¯®«ãç â¥«ï   #####################################ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³®«ãç â¥«ì ################################            ³ ####################### ³
 ³###########################################            ³                         ³
 ³###########################################            ³      ‘ã¬¬  æ¨äà ¬¨      ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³#################################################################################³
 ³‘ã¬¬  ¯à®¯¨áìî   ################################################################³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³ˆáâ®ç­¨ª ¢§­®á   ################################################################³
 ³#################################################################################³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³     Œ..      ãå£ «â¥à               #########################                 ³
 ³                                       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                 ³
 ³               „¥­ì£¨ ¯à¨­ï« ª áá¨à                                              ³
 ³                                       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                 ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³            „… ü    ³#######³                                       ÚÄÄÄÄÄÄÄÄÄ´
 ³                       ÀÄÄÄÄÄÄÄÙ                                       ³ 0402001 ³
 ³                                                                       ÀÄÄÄÄÄÄÄÄÄ´
 ³      #################                       „……’                   ‘ã¬¬       ³
 ³                                    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³â ª®£®  ###########################³#########################³##################³
 ³####################################ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                  ³
 ³####################################³         Š…„ˆ’          ³                  ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                  ³
 ³####################################³                         ³      ¡é ï       ³
 ³####################################³                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄ´
 ³ ­ª ¯®«ãç â¥«ï                     ³                         ³  ç áâ­ë¥    ³á¨¬¢³
 ³ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
 ³®«ãç â¥«ì  ########################³#########################³#############³####³
 ³####################################³                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
 ³####################################³                         ³#############³####³
 ³####################################³                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
]
(   d.Numb_Document:c,
    strDateDoc:c,
    NSR(0):l,
    NSR(1):l, d.Account_Receiver:l,
    NSR(2):l,
    d.Bank_Receiver:l,
    NSR(0):l, Sum:r,
    NSR(1):l,
    NSR(2):l,
    SS(0):l, SS(1):l,
    SG(0):l, SG(1):l,
    Buhg:l,

    d.Numb_Document:c,
    strDateDoc:c,
    NSR(0):l,
    NSR(1):l, d.Account_Receiver:l,
    NSR(2):l,
    d.Bank_Receiver:l,
    NSR(0):l, Sum:r,
    NSR(1):l,
    NSR(2):l,
    SS(0):l, SS(1):l,
    SG(0):l, SG(1):l,
    Buhg:l,

    d.Numb_Document:c,
    strDateDoc:c,
    NSR(0):l, d.Account_Payer, Sum:r ,
    NSR(1):l,
    NSR(2):l,
    SBR(0):l,
    SBR(1):l,
    NSR2(0):l, d.Account_Receiver:l, S(0):f:r,SY(0):c,
    NSR2(1):l,
    NSR2(2):l, S(1):f:r,SY(1):c,
    NSR2(3):l
);

  i=2;
  while(i<ns-1)
[³                                    ³                         ³#############³####³
 ³                                    ³                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
] (S(i):f:r,SY(i):c);
  i=i+1;
  end;

[³                                    ³áç¥â ü                   ³#############³####³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄ´
 ³ˆáâ®ç­¨ª ¢§­®á   ################################################################³
 ³#################################################################################³
 ³ ãå£ «â¥à                   Š áá¨à                                              ³
 ³ #########################                                                       ³
 ³                                                                                 ³
 ³ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                     ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
 
]
(
  S(ns-1):f:r,SY(ns-1):c,
  SG(0):l, SG(1):l,
  Buhg:l
);

 else  /*¡êï¢«¥­¨¥ ­  ¢§­®á ­ «¨ç­ë¬¨ ­®¢®£® ®¡à §æ  (¯® 318-)*/

    StrSplit( d.Bank_Payer, SBP, 66, 56, 2 );
    StrSplit( d.Bank_Receiver, SBR, 66, 56, 20 );
    StrSplit( d.Ground,  SG, 97, 74, 3 );
    StrSplit( SubStr(d.Receiver, 1, 160),  NSRK, 81, 73, 2 );  /* Š¢¨â ­æ¨ï - â ª®£®*/
    StrSplit( SubStr(d.Receiver, 1, 160),  NSRK1, 81, 70, 3 ); /* Š¢¨â ­æ¨ï - ®«ãç â¥«ì*/
    StrSplit( SubStr(d.Receiver, 1, 160),  NSRO,  54, 42, 4);   /* à¤¥à ¨ ¡êï¢«¥­¨¥ - ®«ãç â¥«ì*/
    NSR(0) = SubStr( d.Receiver, 1, 45);
    NSR(1) = SubStr( d.Receiver, 46, 53);
    NSR(2) = SubStr( d.Receiver, 99, 62);

    if ((IsFLAcc(d.Account_Receiver) != 1) AND (d.MFO_Receiver != ""))
        r_account = String(d.Account_Receiver);
    else
        r_account = "";
    end;

    strDateDoc =StrSubSt( strDateDoc, ".", "®¤ ");

    /* à¥®¡à §®¢ ­¨¥ áã¬¬ë ª ¢¨¤ã ••• àã¡. ““ ª®¯. */
    strsum = rubtostralt( d.Sum );
    pos = Index( strsum, "àã¡")+3;
    strsum = StrSubSt( strsum, SubStr( strsum, pos, Index( strsum, " ", pos) - pos), ".");
    strsum = StrSubSt( strsum, SubStr( strsum, Index( strsum, "ª®¯")+3), ".");

    StrSplit( strsum, SS, 98, 58, 2 );
    StrSplit( strsum, SS1, 98, 83, 2 );
    StrSplit( strsum, SS2, 97, 53, 2 );

    i = 0;
    while ( i < 20)
        S(i) = "";
        SY(i) = "";
        i = i+1;
    end;


    if((d.Symbol_Cach ==" 0") OR (d.Symbol_Cach =="  0"))
        sc.Kind             = 1;
        sc.iApplicationKind = d.iApplicationKind;
        sc.ApplicationKey   = d.ApplicationKey;
        rc = GetGE(sc);
        i=0;
        while(rc AND (sc.iApplicationKind == d.iApplicationKind) AND (sc.ApplicationKey == d.ApplicationKey))
            S(i)=sc.Sum;
            SY(i)=sc.Symbol;
            i=i+1;
            rc = Next(sc);
        end;
    else
        S (0)=d.Sum;
        SY(0)=d.Symbol_Cach;
        i=1;
    end;

[
                                                                                                 ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
     ¡êï¢«¥­¨¥ ­  ¢§­®á ­ «¨ç­ë¬¨                                                               ³     Š®¤ ä®à¬ë      ³
                                                                                                 ³  ¤®ªã¬¥­â  ¯® Š“„ ³
                    ÚÄÄÄÄÄÄÄ¿                                                                    ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     šŸ‚‹…ˆ…  ü  ³#######³                                                                    ³      0402001       ³
                    ÀÄÄÄÄÄÄÄÙ                                                                    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
     #####################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                                  „……’
                                                           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
     â ª®£® ##############################################³ ‘ç¥â ü ########################³                         ³
     ######################################################ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´      ################## ³
     ##############################################################         Š…„ˆ’          ³                         ³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´       ‘ã¬¬  æ¨äà ¬¨     ³
     ®«ãç â¥«ì ###########################################³ ‘ç¥â ü ########################³                         ³
     ######################################################ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ######################################################                                 ³     ¢ â®¬ ç¨á«¥         ³
     ###################################################### ˆ ############  Š ######### ³     ¯® á¨¬¢®« ¬:        ³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÄ      ÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     à/áç¥â ü  #########################    Š€’  ###########                              ³                         ³
               ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ¨¬¥­®¢ ­¨¥ ¡ ­ª -¢­®á¨â¥«ï  ######################################################## ³á¨¬¢®«³      áã¬¬        ³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     #################################################################### ˆŠ #########     ³ #####³##################³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ¨¬¥­®¢ ­¨¥ ¡ ­ª -¯®«ãç â¥«ï #########################################################³ #####³##################³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
](   d.Numb_Document:c,
    strDateDoc:c,
    NSR(0):l,
    d.Account_Payer,
    NSR(1):l,
    Sum:r,
    NSR(2):l,
    NSRO(0):l,
    d.Account_Receiver,
    NSRO(1):l,
    NSRO(2):l,
    NSRO(3):l,
    inn:l, kpp:l,
    r_account:l,
    okato:l,
    SBP(0),
    SBP(1),  BIC_Payer:l,     SY(0):c,     S(0):r,
    SBR(0),  SY(1):c,         S(1):r
);

if ( S(4) != "")
    j = 0; k = 2;
    while (j < (i-4))
[    ###################################################################################### ³ #####³##################³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]
    (SBR(j+1),  SY(k):c,     S(k):r);
    j = j+1;
    k = k+1;
    end;
else
    k = 2;
end;

[    #################################################################### ˆŠ   #########   ³ #####³##################³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ‘ã¬¬  ¯à®¯¨áìî ####################################################################### ³ #####³##################³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
     #################################################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                                                        (æ¨äà ¬¨)
     ˆáâ®ç­¨ª ¯®áâã¯«¥­¨ï  ###########################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     #################################################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     #################################################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     ®¤¯¨áì ª«¨¥­â                     ãå£ «â¥àáª¨© à ¡®â­¨ª            Š áá®¢ë© à ¡®â­¨ª
                                        #########################

     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      Š‚ˆ’€–ˆŸ  ü    ³#######³                                                                ³     Š®¤ ä®à¬ë        ³
                      ÀÄÄÄÄÄÄÄÙ                                                                ³ ¤®ªã¬¥­â  ¯® Š“„    ³
                                                                                               ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     #####################                                                                     ³      0402001         ³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                                                ÚÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     â ª®£® #############################################################################³  „«ï § ç¨á«¥­¨ï ­  áç¥â ü ³
     #####################################################################################³                           ³
     ®«ãç â¥«ì ##########################################################################³ ######################### ³
     #####################################################################################ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ###########################################    ˆ  ############ Š  #########      ³         ‘ã¬¬  æ¨äà ¬¨     ³
                                                         ÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄ     ³                           ³
     à/áç¥â ü  #########################    Š€’  ###########                            ³   ####################### ³
               ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
      ¨¬¥­®¢ ­¨¥ ¡ ­ª -¢­®á¨â¥«ï  ###################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     #############################################################################################     ˆŠ   #########
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ           ÄÄÄÄÄÄÄÄÄ
      ¨¬¥­®¢ ­¨¥ ¡ ­ª -¯®«ãç â¥«ï  ##################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     #############################################################################################     ˆŠ   #########
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ           ÄÄÄÄÄÄÄÄÄ
     ‘ã¬¬  ¯à®¯¨áìî ##################################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     #################################################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     ˆáâ®ç­¨ª ¯®áâã¯«¥­¨ï  ##########################################################################  (æ¨äà ¬¨)
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     #################################################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     #################################################################################################################
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     Œ¥áâ® ¯¥ç â¨       ãå£ «â¥àáª¨© à ¡®â­¨ª            Š áá®¢ë© à ¡®â­¨ª
      (èâ ¬¯ )          #########################

                        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      „…  ü        ³#######³                                                                   ³     Š®¤ ä®à¬ë     ³
                      ÀÄÄÄÄÄÄÄÙ                                                                   ³ ¤®ªã¬¥­â  ¯® Š“„ ³
                                                                                                  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      #####################                                                                       ³      0402001      ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                                                       ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
                                                                            „……’
                                                           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      â ª®£® #############################################³ ‘ç¥â ü ########################³                         ³
      #####################################################ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´  ###################### ³
      ##############################################################       Š…„ˆ’           ³                         ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                         ³
      ®«ãç â¥«ì ##########################################³ ‘ç¥â ü ########################³     ‘ã¬¬  æ¨äà ¬¨       ³
      #####################################################ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      #####################################################                                 ³     ¢ â®¬ ç¨á«¥         ³
      #####################################################  ˆ ############ Š ######### ³     ¯® á¨¬¢®« ¬:        ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ      ÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      à/áç¥â ü  #########################       Š€’    ###########                        ³                         ³
               ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¢­®á¨â¥«ï  ########################################################³á¨¬¢®«³   áã¬¬           ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ##################################################################  ˆŠ  #########    ³ #####³##################³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¯®«ãç â¥«ï ########################################################³ #####³##################³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
](   SBR(k-1),  BIC_Receiver:l,  SY(k):c,     S(k):r,
     SS(0):l, SY(k+1):c,        S(k+1):r,
     SS(1):l,
     SG(0):l,
     SG(1):l,
     SG(2):l,
     GetFioOper(d.Oper,true):c,
     d.Numb_Document:c,
     strDateDoc:c,
     NSRK(0):l,
     NSRK(1):l,
     NSRK1(0):l,
     d.Account_Receiver,
     NSRK1(1):l,
     NSRK1(2):l,
      inn:l, kpp:l,
      r_account:l,  okato:l, Sum:r,
      SBP(0),
      SBP(1),  BIC_Payer:l,
      SBR(0),
      SBR(1),  BIC_Receiver:l,
      SS1(0):l,
      SS1(1):l,
      SG(0):l,
      SG(1):l,
     SG(2):l,
      GetFioOper(d.Oper,true):c,
      d.Numb_Document:c,
      strDateDoc:c,
     NSR(0):l,
      d.Account_Payer:l,
     NSR(1):l,
     Sum:r,
     NSR(2):l,
     NSRO(0):l,
      d.Account_Receiver:l,
     NSRO(1):l,
     NSRO(2):l,
     NSRO(3):l,
     inn:l, kpp:l,
    r_account:l,
    okato:l,
    SBP(0),
    SBP(1),  BIC_Payer:l,     SY(0):c,     S(0):r,
    SBR(0),  SY(1):c,     S(1):r
);

if ( S(4) != "")
    j = 0; k = 2;
    while (j < (i-4))
    [     ######################################################################################³ #####³##################³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]
    (SBR(j+1),  SY(k):c,     S(k):f:r);
    j = j+1;
    k = k+1;
    end;
else
    k = 2;
end;

[     ##############################################################     ˆŠ   #########    ³ #####³##################³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ‘ã¬¬  ¯à®¯¨áìî  ######################################################################³ #####³##################³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
      ################################################################################################################
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                                                         (æ¨äà ¬¨)
      ˆáâ®ç­¨ª ¯®áâã¯«¥­¨ï  ##########################################################################################
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ################################################################################################################
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ################################################################################################################
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                              ãå£ «â¥àáª¨© à ¡®â­¨ª            Š áá®¢ë© à ¡®â­¨ª
                              #########################

                              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      
]
(


    SBR(k-1),  BIC_Receiver:l,  SY(k):c,     S(k):f:r,
    SS2(0):l, SY(k+1):c,     S(k+1):f:r,
    SS2(1):l,
    SG(0):l,
    SG(1):l,
    SG(2):l,
    GetFioOper(d.Oper,true):c
);
end;
end;

macro PrintRC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato, date_318P)
Array SP,SBR,SR,NSP,NSR,S,SY,SD,SBP,SS,SG;
var   rc,i,ns,doc,CodeCurr, r_account, n=0, NSRN, NSPN, SBRN, SBPN;
NSRN = NSPN = SBRN = SBPN = TArray(0, 1);

   StrSplit( rubtostralt( d.Sum ), SS, 81,66,2 );
   StrSplit( d.Ground,  SG, 81,62,2 );
   strsplit( d.Bank_Receiver,      SBR,   37,21,2 );
   strsplit( d.Payer,              NSP,   37,29,3 ); // ®â ª®£®
   strsplit( d.Receiver,           NSR,   37,26,4 ); // ª®¬ã
   strsplit( Payer,                SP,    37,29,3 );
   strsplit( Receiver,             SR,    37,29,4 );

 S (0)="";
 SY(0)="";
 S (1)="";
 SY(1)="";

 if((d.Symbol_Cach ==" 0") OR (d.Symbol_Cach =="  0"))
     sc.Kind             = 1;
     sc.iApplicationKind = d.iApplicationKind;
     sc.ApplicationKey   = d.ApplicationKey;

     rc = GetGE(sc);
     ns=0;
     while(rc AND (sc.iApplicationKind == d.iApplicationKind) AND (sc.ApplicationKey == d.ApplicationKey))
        if ( CheckTS( sc.Symbol, LSTS_INCR ) )
           S (ns)=sc.Sum;
           SY(ns)=sc.Symbol;
           ns=ns+1;
        end;
        rc = Next(sc);
     end;
 else
    if ( CheckTS( d.Symbol_Cach, LSTS_INCR ) )
       S (0)=d.Sum;
       SY(0)=d.Symbol_Cach;
    end;
    ns=1;
 end;

 if(ns<2)
   ns=2;
 end;

 doc = GetClientDocument(d.Account_Receiver);
 strsplit( doc, SD, 81,81,2 );

 if( d.Date_Document < PR_NEWDATE ) // ¯à¨å®¤­ë© ª áá®¢ë© ®à¤¥à ‘’€ƒ ®¡à §æ 

    [

     ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
     ³     ˆ•„›‰         ÚÄÄÄÄÄÄÄ¿                                                 ³
     ³     Š€‘‘‚›‰ „… ü  ³#######³                                                 ³
     ³                       ÀÄÄÄÄÄÄÄÙ                                                 ³
     ³   ###################                                                           ³
     ³  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                        „¥¡¥â                  ‘ã¬¬       ³
     ³â ª®£® #############################ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ³#####################################³#########################³#################³
     ³#####################################³                         ³ ¡é ï           ³
     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄ´
     ³ ­ª ¯®«ãç â¥«ï #####################³     Šà¥¤¨â              ³ — áâ­ë¥    ³‘¨¬¢³
     ³#####################################ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
     ³®«ãç â¥«ì ##########################³#########################³############³####³
     ³#####################################³                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
     ³#####################################³                         ³############³####³
     ³#####################################³                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
    ]
    (
      d.Numb_Document:c,
        strDateDoc:c,
        NSR(0):l,
        NSR(1):l, d.Account_Payer:l, Sum:r ,
        NSR(2):l,
        SBR(0):l, SBR(1):l,
        NSR(0):l, d.Account_Receiver:l, S(0):f:r,SY(0):c,
        NSR(1):l,
        NSR(2):l, S(1):f:r,SY(1):c,
        NSR(3):l
    );
      i=2;
      while(i<ns)
    [³                                     ³                         ³############³####³
     ³                                     ³                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
    ] (S(i):r,SY(i):c);
      i=i+1;
      end;

    [³                                     ³                         ³ ˜¨äà ®¯¥à. ³ ## ³
     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄ´
     ³ §­ ç¥­¨¥ ¯« â¥¦  ##############################################################³
     ³#################################################################################³
     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ³‘ã¬¬  ¯à®¯¨áìî ##################################################################³
     ³#################################################################################³
     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ³#################################################################################³
     ³#################################################################################³
     ³                                                                                 ³
     ³®¤¯¨áì ¢­®á¨â¥«ï                                                                ³
     ³                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                             ³
     ³ƒ«. ¡ãå£ «â¥à               ãå£ «â¥à                         Š áá¨à             ³
     ³#########################   #########################                            ³
     ³                                                                                 ³
     ³ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ³
     ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
     
    ]
    (
       d.Shifr_Oper:c,
       SG(0):l, SG(1):l,
       SS(0):l, SS(1):l,
       SD(0):l, SD(1):l,
       GetFioOper({FIO_Book},true):l, Buhg:l
    );
  /* ¯à¨å®¤­ë© ª áá®¢ë© ®à¤¥à  ¯® 199-*/
  elif (d.Date_Document < date_318P)
    i = 1;
    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    if(GetEQ(sc))
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          Symb(0)    = sc.Symbol;
          SymbSum(0) = sc.Sum;
       else
          Symb(0)    = "";
          SymbSum(0) = "";
          i = 0;
       end;
    else
       if ( CheckTS( d.symbol_cach, LSTS_INCR ) )
          Symb(0)    = d.symbol_cach;
          SymbSum(0) = d.Sum;
       else
          Symb(0)    = "";
          SymbSum(0) = "";
       end;
       Symb(1)    = "";
       Symb(2)    = "";
       Symb(3)    = "";
       SymbSum(1) = "";
       SymbSum(2) = "";
       SymbSum(3) = "";
    end;

    while( next(sc)
           and (sc.Kind             == 1                  )
           and (sc.iApplicationKind == d.iApplicationKind )
           and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          Symb(i)    = sc.Symbol;
          SymbSum(i) = sc.Sum;
          i = i + 1;
       end;
    end;

    j = 0;
    while( j < 4 )
       if ( (ValType(Symb(j)) == V_UNDEF) and (ValType(SymbSum(j)) == V_UNDEF) )
          Symb(j)    = "";
          SymbSum(j) = "";
       end;
       j = j + 1;
    end;

    CodeCurr = d.Code_Currency;
    if(CodeCurr == 0)
        CodeCurr = 810;
    end;

    strsplit( d.Bank_Receiver,      SBR, 53, 53, 2 );
    strsplit( rubtostralt( d.Sum ) + " (" + CodeCurr + ")", SS, 79, 36, 3 );
    strsplit( d.Receiver,           NSR, 53, 53, 2 );
    strsplit( d.Ground,             SG,  79, 63, 2 );

    [
                                      ÚÄÄÄÄÄÄÄ¿
           à¨å®¤­ë© ª áá®¢ë© ®à¤¥à ü ³#######³
              ###################     ÀÄÄÄÄÄÄÄÙ
                                                                         „……’
                                                               ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
          â ª®£®                                              ³áç.ü #######################³                        ³
          #####################################################³                            ³ ###################### ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                        ³
          #####################################################          Š…„ˆ’             ³                        ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                        ³
           ­ª ¯®«ãç â¥«ï ######### ###########################³áç.ü #######################³                        ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                            ³                        ³
          ®«ãç â¥«ì ##########################################³                            ³                        ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´      ‘ã¬¬  æ¨äà ¬¨     ³
                                                                                            ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
          ‘ã¬¬  ¯à®¯¨áìî (­ ¨¬¥­®¢ ­¨¥ (ª®¤) ¢ «îâë) ####################################   ³
                                                     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ###############################################################################   ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ###############################################################################   ³¢ â®¬ ç¨á«¥ ¯® á¨¬¢®« ¬:
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄ¿
                                                                                            ³  áã¬¬      ³  á¨¬¢®«   ³
                                                                                            ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´
                                                                                            ³############³###########³
                                                                                            ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´
                                                                                            ³############³###########³
                                                                                            ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´
          ˆáâ®ç­¨ª ¢§­®á  ###############################################################   ³############³###########³
                          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´
          ###############################################################################   ³############³###########³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÙ

          ®¤¯¨áì ¢­®á¨â¥«ï               ãå£ «â¥àáª¨© à ¡®â­¨ª      Š áá®¢ë© à ¡®â­¨ª

                                        ##########################

              Œ..
    
    ]
    ( d.Numb_Document:l,
      strDateDoc:c,
      d.Real_Payer,
      NSR(0),
      Sum:c,
      NSR(1),
      BIC_Receiver,
      d.bank_Receiver,
      d.Real_Receiver,
      NSR(0),
      SS(0):l,
      SS(1):l,
      SS(2):l,
      SymbSum(0):f,
      Symb(0):c,
      SymbSum(1):f,
      Symb(1):c,
      SG(0),
      SymbSum(2):f,
      Symb(2):c,
      SG(1),
      SymbSum(3):f,
      Symb(3):c,
      GetFioOper(d.Oper,true):c);
 /* ¯à¨å®¤­ë© ª áá®¢ë© ®à¤¥à ¯® 318- */
 else

    StrSet(strDateDoc, strlen(strDateDoc), "®");
    strDateDoc = strDateDoc + "¤ ";

    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    i = 0;  n = 0;
    while ( i < 20)
        Symb(i) = "";
        SymbSum(i) = "";
        i = i+1;
    end;

    if(GetEQ(sc))
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          Symb(0)    = sc.Symbol;
          SymbSum(0) = sc.Sum;
          i = 1;
       else
          Symb(0)    = "";
          SymbSum(0) = "";
          i = 0;
       end;
    else
       if ( CheckTS( d.symbol_cach, LSTS_INCR ) )
          Symb(0)    = d.symbol_cach;
          SymbSum(0) = d.Sum;
          i = 1;
       else
          Symb(0)    = "";
          SymbSum(0) = "";
          i = 0;
       end;
    end;

    while( next(sc)
           and (sc.Kind             == 1                  )
           and (sc.iApplicationKind == d.iApplicationKind )
           and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          Symb(i)    = sc.Symbol;
          SymbSum(i) = sc.Sum;
          i = i + 1;
       end;
    end;

    j = 0;
    while( j < i )
       if ( (ValType(Symb(j)) == V_UNDEF) and (ValType(SymbSum(j)) == V_UNDEF) )
          Symb(j)    = "";
          SymbSum(j) = "";
       end;
       j = j + 1;
    end;

    SBRN = DoStrSplit( d.Bank_Receiver, 48, 48, 20 );
    strsplit( rubtostralt( d.Sum ), SS, 78, 31, 3 );
    NSRN = DoStrSplit( d.Receiver, 45, 45, 8);
    NSPN = DoStrSplit( d.Payer   , 45, 45, 8);
    strsplit( d.Ground,             SG,  108, 87, 2 );
    SBPN = DoStrSplit( d.Bank_Payer, 48, 48, 3 );

    if ((IsFLAcc(d.Account_Receiver) != 1) AND (d.MFO_Receiver != ""))
        r_account = String(d.Account_Receiver);
    else
        r_account = "";
    end;
   [
                                                                                                  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                                                                                                  ³    Š®¤ ä®à¬ë     ³
                                                                                                  ³ ¤®ªã¬¥­â  ¯® Š“„³
                                                                                                  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
                                                                                                  ³     0402008      ³
                                                                                                  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
                                      ÚÄÄÄÄÄÄÄ¿
           à¨å®¤­ë© ª áá®¢ë© ®à¤¥à ü ³#######³
              #####################   ÀÄÄÄÄÄÄÄÙ
              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                                         „……’
                                                        ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
          â ª®£®                                       ³ ‘ç¥â ü ########################³                           ³
          ############################################# ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´    ###################### ³]
  (
      d.Numb_Document:c,
      strDateDoc:c,
      d.Account_Payer:l,
      NSPN(0):l,        Sum:r
  );


  n = 1;
  while ( (NSPN(n+2)!="") AND (n<6))
    [      #############################################                                  ³                           ³]( NSRN(n):l);
    n = n+1;
  end;

  [      #############################################                                  ³                           ³
         #############################################                  Š…„ˆ’          ³                           ³
         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                           ³
         ®«ãç â¥«ì                                    ³ ‘ç¥â ü ########################³                           ³
  ]
  (   NSPN(n):l,
      NSPN(n+1):l,
      d.Account_Receiver:l);

  if ( NSRN(3)!="" )
  [      ############################################# ³                                ³                           ³
         ############################################# ³                                ³                           ³
  ](    NSRN(0):l,
        NSRN(1):l);
  else
    NSRN(4) = NSRN(2);
    NSRN(2) = NSRN(0);
    NSRN(3) = NSRN(1);
  end;


  [      ############################################# ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´         ‘ã¬¬  æ¨äà ¬¨     ³
         ############################################# ³ ‘ç¥â ü                         ³                           ³
         ############################################# ³                                ³                           ³
  ]( NSRN(2):l,
     NSRN(3):l,
     NSRN(4):l);

  n = 5;
  while ( ( NSRN(n) != "" ) AND (n<8) )
    [      ############################################# ³                                ³                           ³](NSRN(n):l);
    n=n+1;
  end;

  [      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ˆ  ############           Š  #########          Š€’  ###########         ³        ¢ â®¬ ç¨á«¥        ³
             ÄÄÄÄÄÄÄÄÄÄÄÄÄ               ÄÄÄÄÄÄÄÄÄÄ                ÄÄÄÄÄÄÄÄÄÄÄÄ         ³        ¯® á¨¬¢®« ¬:       ³
         à/áç¥â ü  #########################                                            ³                           ³
                  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ¨¬¥­®¢ ­¨¥ ¡ ­ª -¢­®á¨â¥«ï  ################################################ ³ á¨¬¢®« ³   áã¬¬           ³
  ]
  ( inn:l,  kpp:l,  okato:l,
    r_account:l,
    SBPN(0):l);

  n = 1;
  while ( (ValType (SBPN(n+1)) != V_UNDEF) AND ( SBPN(n+1) != "") AND ( SBPN(n+1) != " ") )
  [      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´        ³                  ³
         ############################################################################## ³        ³                  ³
  ]( SBPN(n):l);
  n = n+1;
  end;

  [      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ##########################################################     ˆŠ   ######### ³  ##### ³##################³
         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ¨¬¥­®¢ ­¨¥ ¡ ­ª -¯®«ãç â¥«ï ################################################ ³  ##### ³##################³
         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
   ]
   (
      SBPN(n):l,  BIC_Payer:l,     Symb(0):c,     SymbSum(0):f:r,
      SBRN(0):l,  Symb(1):c,       SymbSum(1):f:r
   );



   if ( (Symb(2) == "") OR ((Symb(2) != "") and (Symb(3) == "")) )
    [      ############################################################################## ³  ##### ³##################³
           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]
    (SBRN(1):l,  Symb(2):c,       SymbSum(2):f:r);
    j = 3;
    if  ( (ValType (SBRN(3)) != V_UNDEF) AND ( SBRN(3) != "") AND ( SBRN(3) != " ") )
       [      ############################################################################## ³  ##### ³##################³
              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ] (SBRN(2):l,  "", "");
       j = 4;
    end;
   else
        j = 2;
        while ( j< i-1 )
            [      ############################################################################## ³  ##### ³##################³
                   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
            ]
            (SBRN(j-1):l,  Symb(j):c,       SymbSum(j):f:r);
            j = j+1;
        end;
   end;



   [      ###########################################################    ˆŠ   ######### ³  ##### ³##################³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ‘ã¬¬  ¯à®¯¨áìî á ãª § ­¨¥¬ ­ ¨¬¥­®¢ ­¨ï ¢ «îâë ############################### ³  ##### ³##################³
                                                         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
          ############################################################################################################
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
          ############################################################################################################
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
          ˆáâ®ç­¨ª ¯®áâã¯«¥­¨ï #######################################################################################
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
          ############################################################################################################
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

          ®¤¯¨áì ¢­®á¨â¥«ï               ãå£ «â¥àáª¨© à ¡®â­¨ª                   Š áá®¢ë© à ¡®â­¨ª
                                          ##########################


          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
    
    ]
    (
      SBRN(j-1):l,      BIC_Receiver:l,    Symb(j):c,        SymbSum(j):f:r,
      SS(0):l,         Symb(j+1):c,       SymbSum(j+1):f:r,
      SS(1):l,
      SS(2):l,
      SG(0):l,
      SG(1):l,
      GetFioOper(d.Oper,true):c
    );
 end;
end;

macro PrintOC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, date_318P)
Array SS,SP,SBR,SR,SG,NSP,NSR,S,SY,SD, Symb, SymbSum;
var  rc,i,ns,doc,CodeCurr, nameDoc = "", numbDoc = "", placeDoc = "", dateDoc = "", strDoc1 = "", strDoc2 = "", n, NSPN = TArray(0, 1), SBRN = TArray(0, 1);


   strsplit( rubtostralt( d.Sum ), SS,    81,66,2 );
   strsplit( d.Ground,             SG,    43,62,3 );
   strsplit( d.Bank_Receiver,      SBR,   37,37,2 );
   strsplit( d.Payer,              NSP,   38,30,3 ); // ®â ª®£®
   strsplit( d.Receiver,           NSR,   38,30,4 ); // ª®¬ã
   strsplit( Payer,                SP,    38,30,3 );
   strsplit( Receiver,             SR,    38,30,4 );

 S (0)="";
 SY(0)="";
 S (1)="";
 SY(1)="";
 if((d.Symbol_Cach ==" 0") OR (d.Symbol_Cach =="  0"))
     sc.Kind             = 1;
     sc.iApplicationKind = d.iApplicationKind;
     sc.ApplicationKey   = d.ApplicationKey;

     rc = GetGE(sc);
     ns=0;
     while(rc AND (sc.iApplicationKind == d.iApplicationKind) AND (sc.ApplicationKey == d.ApplicationKey))
        if ( CheckTS( sc.Symbol, LSTS_DECR ) )
           S (ns)=sc.Sum;
           SY(ns)=sc.Symbol;
           ns=ns+1;
        end;
        rc = Next(sc);
     end;
 else
    if ( CheckTS( d.Symbol_Cach, LSTS_DECR ) )
       S (0)=d.Sum;
       SY(0)=d.Symbol_Cach;
    end;
    ns=1;
 end;

 if(ns<2)
   ns=2;
 end;

 doc = GetClientDocument(d.Account_Payer);
 strsplit( doc, SD, 81, 81, 2 );

 if( d.Date_Document < PR_NEWDATE ) // à áå®¤­ë© ª áá®¢ë© ®à¤¥à ‘’€ƒ ®¡à §æ 

    [
     ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
     ³     €‘•„›‰                       ³        ¬¥áâ®  ¤«ï       ³                 ³
     ³     Š€‘‘‚›‰ „… ü #######        ³         ­ ª«¥©ª¨        ³    ü #######    ³
     ³                                     ³          â «®­          ³  â «®­ ¢ ª ááã  ³
     ³   ###################               ³                         ³                 ³
     ³  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ              ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ³‚ë¤ âì ##############################³          „¥¡¥â          ³     ‘ã¬¬        ³
     ³#####################################³#########################³#################³
     ³#####################################³                         ³                 ³
     ³                                     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                 ³
     ³                                     ³          Šà¥¤¨â         ³                 ³
     ³#####################################³                         ÃÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄ´
     ³ ¨¬¥­®¢ ­¨¥ ¡ ­ª                    ³#########################³ — áâ­ë¥    ³‘¨¬¢³
     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
     ³ §­ ç¥­¨¥ ¯« â¥¦  ########################################### ³############³####³
     ³############################################################## ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
     ³                                                               ³############³####³
     ³                                                               ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
    ]
    (
      d.Numb_Document:c,d.Numb_Document:c,
        strDateDoc:c,
        NSP(0):l,
        NSP(1):l, d.Account_Payer:l, Sum:r ,
        NSP(2):l,
        d.Bank_Receiver, d.Account_Receiver:l,
        SG(0),  S(0):r,SY(0):c,
        SG(1),  S(1):r,SY(1):c
    );
      i = 2;
      while( i < ns )
    [³                                                               ³############³####³
     ³                                                               ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄ´
    ] (S(i):r,SY(i):c);
      i = i + 1;
      end;

    [³                                                               ³ ˜¨äà ®¯¥à. ³ ## ³
     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄ´
     ³‘ã¬¬  ¯à®¯¨áìî ##################################################################³
     ³#################################################################################³
     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ³#################################################################################³
     ³#################################################################################³
     ³                                                                                 ³
     ³“ª § ­­ãî ¢ ®à¤¥à¥ áã¬¬ã ¯®«ãç¨«                                                 ³
     ³                                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                 ³
     ³ƒ«. ¡ãå£ «â¥à                  ãå£ «â¥à                      Š áá¨à             ³
     ³#########################   #########################                            ³
     ³                                                                                 ³
     ³ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ³
     ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
     
    ]
    (
       d.Shifr_Oper:c,
       SS(0):l, SS(1):l,
       SD(0):l, SD(1):l,
       GetFioOper({FIO_Book},true):l, Buhg:l

    );
 elif (d.Date_Document < date_318P) // à áå®¤­ë© ª áá®¢ë© ®à¤¥à  ®¡à §æ  (199-)
    i = 1;
    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    if(GetEQ(sc))
        if ( CheckTS( sc.Symbol, LSTS_DECR ) )
           Symb(0)    = sc.Symbol;
           SymbSum(0) = sc.Sum;
        else
           Symb(0)    = "";
           SymbSum(0) = "";
           i = 0;
        end;
    else
        if ( CheckTS( d.Symbol_Cach, LSTS_DECR ) )
           Symb(0)    = d.symbol_cach;
           SymbSum(0) = d.Sum;
        else
           Symb(0)    = "";
           SymbSum(0) = "";
        end;
        Symb(1)    = "";
        Symb(2)    = "";
        Symb(3)    = "";
        SymbSum(1) = "";
        SymbSum(2) = "";
        SymbSum(3) = "";
    end;

    While(next(sc)
         and (sc.Kind             == 1                  )
         and (sc.iApplicationKind == d.iApplicationKind )
         and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_DECR ) )
          Symb(i)    = sc.Symbol;
          SymbSum(i) = sc.Sum;
          i = i + 1;
       end;
    end;

    j = 0;
    While( j < 4 )
       if ((ValType(Symb(j)) == V_UNDEF) and (ValType(SymbSum(j)) == V_UNDEF))
          Symb(j)="";
          SymbSum(j)="";
       end;
       j = j + 1;
    end;

    CodeCurr = d.code_currency;

    if(CodeCurr == 0)
        CodeCurr = 810;
    end;

    strsplit( d.Payer,              NSP,   53,  46,  3 );
    strsplit( rubtostralt( d.Sum ) + " (" + CodeCurr + ")", SS, 79, 30, 3 );
    strsplit( d.Ground,             SG,    69,  50,  4 );

    SetDocParm( acc, d.Account_Payer, d.Code_Currency, @nameDoc, @numbDoc, @placeDoc, @dateDoc );

    [
                                      ÚÄÄÄÄÄÄÄ¿                                   Œ…‘’ „‹Ÿ
            áå®¤­ë© ª áá®¢ë© ®à¤¥à ü ³#######³                                €Š‹…‰Šˆ ’€‹€
                                      ÀÄÄÄÄÄÄÄÙ
              ###################                                        „……’
                                                               ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                                                               ³áç.ü #######################³ ü â «®­                ³
          ‚ë¤ âì ##############################################³                            ³ ¢ ª ááã                ³
                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                        ³
          #####################################################          Š…„ˆ’             ³ #                      ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          #####################################################³áç.ü #######################³ ###################### ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                            ³                        ³
          #####################################################³                            ³                        ³
                                           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                            ³                        ³
           ¨¬¥­®¢ ­¨¥ ¡ ­ª                ³ ˆŠ  #########    ³                            ³     ‘ã¬¬  æ¨äà ¬¨      ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
           §­ ç¥­¨¥ ¯« â¥¦                                                                 ³
                             ##################################################             ³¢ â®¬ ç¨á«¥ ¯® á¨¬¢®« ¬:
                             ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ             ÃÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄ¿
          #####################################################################             ³   áã¬¬     ³  á¨¬¢®«   ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ             ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´
          #####################################################################             ³############³###########³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ             ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´
          #####################################################################             ³############³###########³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´
          ‘ã¬¬  ¯à®¯¨áìî (­ ¨¬¥­®¢ ­¨¥ (ª®¤) ¢ «îâë) ####################################   ³############³###########³
                                                     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´
          ###############################################################################   ³############³###########³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÙ

          à¥¤êï¢«¥­ ¤®ªã¬¥­â, ã¤®áâ®¢¥àïîé¨© «¨ç­®áâì ####################################, ü ####################
                                                      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
          ‚ë¤ ­ ################################################################### ########## £.
                ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ÄÄÄÄÄÄÄÄÄÄ
          “ª § ­­ãî ¢ ®à¤¥à¥ áã¬¬ã ¯®«ãç¨«
                                               ______________________
                                                (¯®¤¯¨áì ¯®«ãç â¥«ï)

          Š®­âà®«¨àãîé¨© à ¡®â­¨ª                   ãå£ «â¥àáª¨© à ¡®â­¨ª                      Š áá®¢ë© à ¡®â­¨ª

                                                   ########################

    
    ]
    ( d.Numb_Document:l,
      strDateDoc:c,
      d.Real_Payer,
      NSP(0),
      NSP(1),
      d.Numb_Document:l,
      NSP(2),
      d.Real_Receiver,
      Sum:r,
      d.Bank_Receiver,
      BIC_receiver,
      SG(0),
      SG(1),
      SG(2),
      SymbSum(0),
      Symb(0):c,
      SG(3),
      SymbSum(1),
      Symb(1):c,
      SS(0):l,
      SymbSum(2),
      Symb(2):c,
      SS(1):l,
      SymbSum(3),
      Symb(3):c,
      nameDoc:l, numbDoc:l,
      placeDoc:l, dateDoc:l,
      GetFioOper(d.Oper,true):c );
 /* à áå®¤­ë© ª áá®¢ë© ®à¤¥à ¯® 318-*/
 else

    StrSet(strDateDoc, strlen(strDateDoc), "®");
    strDateDoc = strDateDoc + "¤ ";

    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    i = 0;
    while ( i < 50)
        Symb(i) = "";
        SymbSum(i) = "";
        i = i+1;
    end;

    if(GetEQ(sc))
        if ( CheckTS( sc.Symbol, LSTS_DECR ) )
           Symb(0)    = sc.Symbol;
           SymbSum(0) = sc.Sum;
           i = 1;
        else
           Symb(0)    = "";
           SymbSum(0) = "";
           i = 0;
        end;
    else
        if ( CheckTS( d.Symbol_Cach, LSTS_DECR ) )
           Symb(0)    = d.symbol_cach;
           SymbSum(0) = d.Sum;
           i = 1;
        else
           Symb(0)    = "";
           SymbSum(0) = "";
           i = 0;
        end;

    end;

    While(next(sc)
         and (sc.Kind             == 1                  )
         and (sc.iApplicationKind == d.iApplicationKind )
         and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_DECR ) )
          Symb(i)    = sc.Symbol;
          SymbSum(i) = sc.Sum;
          i = i + 1;
       end;
    end;

    j = 0;
    While( j < i )
       if ((ValType(Symb(j)) == V_UNDEF) and (ValType(SymbSum(j)) == V_UNDEF))
          Symb(j)="";
          SymbSum(j)="";
       end;
       j = j + 1;
    end;


    NSPN = DoStrSplit( d.Payer, 50, 50, 7 );
    strsplit( d.Ground,             SG,    79,  60,  20 );
    SBRN = DoStrSplit( d.Bank_Receiver, 32, 32, 10 );
    strsplit( rubtostralt( d.Sum ), SS,    81,32,2 );

    SetDocParm( acc, d.Account_Payer, d.Code_Currency, @nameDoc, @numbDoc, @placeDoc, @dateDoc );

    if (nameDoc != "")
        strDoc1 = "à¥¤êï¢«¥­ ¤®ªã¬¥­â, ã¤®áâ®¢¥àïîé¨© «¨ç­®áâì:" + " " + nameDoc + " ü " + numbDoc;
        strDoc2 = "‚ë¤ ­" + " " + placeDoc + " " + dateDoc;
    end;

    [
                                                                                                   ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                                                                                                   ³    Š®¤ ä®à¬ë     ³
                                                                                                   ³ ¤®ªã¬¥­â  ¯® Š“„³
                                                                                                   ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
                                                                                                   ³     0402009      ³
                                                                                                   ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

                                                                                            ÚÄ Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä¿
                                      ÚÄÄÄÄÄÄÄ¿                                                   âàë¢­®© â «®­
            áå®¤­ë© ª áá®¢ë© ®à¤¥à ü ³#######³                                             ³  ª à áå®¤­®¬ã ª áá®¢®¬ã ³
                                      ÀÄÄÄÄÄÄÄÙ                                                  ®à¤¥àã ü #######
             #####################                                                          ³             ÄÄÄÄÄÄÄ     ³
             ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                                          ÀÄ Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä  Ù

                                                                         „……’              ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                                                             ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´   Œ¥áâ® ¤«ï ­ ª«¥©ª¨    ³
          ‚ë¤ âì                                             ³‘ç¥â ü #######################³   ®âàë¢­®£® â «®­       ³
          ###################################################ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ###################################################                               ³                         ³
          ###################################################                               ³                         ³
    ]( d.Numb_Document:c,
       d.Numb_Document:c,
       strDateDoc:c,
       d.Account_Payer,
       NSPN(0),
       NSPN(1),
       NSPN(2));

    n = 3;
    while ((NSPN(n+1)!="") AND (n<6))
    [     ###################################################                               ³                         ³]( NSPN(n):l);
      n = n+1;
    end;

    [     ###################################################            Š…„ˆ’             ³ ######################  ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                         ³
           ¨¬¥­®¢ ­¨¥ ¡ ­ª  ################################³‘ç¥â ü #######################³      ‘ã¬¬  æ¨äà ¬¨      ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]( NSPN(n),
       Sum:c,
       SBRN(0),
       d.Account_Receiver);

    n = 1;
    while ( SBRN(n+1) != "" )
    [     ################################################################################# ³                         ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                         ³
    ] ( SBRN(n));
    n = n+1;
    end;


    [     ###############################################################   ˆŠ  #########  ³     ¢ â®¬ ç¨á«¥         ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ       ÄÄÄÄÄÄÄÄÄÄÄÄ´     ¯® á¨¬¢®« ¬:        ³
          ‘ã¬¬  ¯à®¯¨áìî á ãª § ­¨¥¬ ­ ¨¬¥­®¢ ­¨ï ¢ «îâë ################################   ³                         ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ###############################################################################   ³á¨¬¢®«³     áã¬¬         ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
           ¯à ¢«¥­¨¥ ¢ë¤ ç¨ ############################################################   ³ #### ³##################³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]
   (  SBRN(n),
      BIC_Receiver,
      SS(0):l,
      SS(1):l,
      SG(0),
      Symb(0):c,
      SymbSum(0):f:r
    );


    if ( (Symb(1) == "") OR ( (Symb(1) != "") AND (Symb(2) == "") ) OR  ( (Symb(1) != "") AND (Symb(2) != "") AND ((Symb(3) == ""))))
    [     ################################################################################  ³ #### ³##################³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´]
    (
      SG(1),
      Symb(1):c,
      SymbSum(1):f:r
    );
    j = 2;
    else
        j = 1;
        while ( j< i-1 )
        [     ################################################################################  ³ #### ³##################³
              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´]
        (
            SG(j),
            Symb(j):c,
            SymbSum(j):f:r
        );
        j = j+1;
        end;
    end;

    [     ################################################################################  ³ #### ³##################³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
          #########################################################################################################
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                           (­ ¨¬¥­®¢ ­¨¥ ¤®ªã¬¥­â )
          #########################################################################################################
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                                      (ª¥¬ ¢ë¤ ­)
          “ª § ­­ãî ¢ à áå®¤­®¬ ª áá®¢®¬ ®à¤¥à¥ áã¬¬ã ¯®«ãç¨«
                                                                ______________________
                                                                  («¨ç­ ï ¯®¤¯¨áì)

          ãå£ «â¥àáª¨© à ¡®â­¨ª                    Š®­âà®«¥à                  Š áá®¢ë© à ¡®â­¨ª
          ########################

          ________________________            ________________________       ________________________
    
    ]
    (
      SG(j),
      Symb(j):c,
      SymbSum(j):f:r,
      strDoc1,
      strDoc2:l,
      GetFioOper(d.Oper,true):c );
 end;

end;


/*                   à¨å®¤­® - à áå®¤­ë© ª áá®¢ë© ®à¤¥à    */
macro PrintORC(strDateDoc,Sum, StrPayDate,kind_doc)
Array SSP,SGR,SGP,S,SY,SD, SSR, SymbP, SymbSumP, SymbR, SymbSumR;
var  rc,i,k,ns,doc, nameDoc = "", numbDoc = "", placeDoc = "", dateDoc = "", strDoc1 = "", strDoc2 = "",pos,payer, BuhP, BuhR, Name_vn = "", str="",
     PNumbDoc, RNumbDoc, PayerP, PayerR, ReceiverP, ReceiverR, PBank_Pay, RBank_Pay, RBank_Rec, PBank_rec, Pdate, Rdate, Psum, Rsum, NamePayer, NameReceiver ;
var cl  = TBFile("client.dbt", "R", 0, "client.dbt", "bank.def"), val = TArray(0, 1), NM = TArray(0, 1), NM1 = TArray(0, 1), NM2 = TArray(0, 1);
  
   strsplit( rubtostralt( d.Sum ), SSP,   42,27,20 );
   strsplit( rubtostralt( d.Sum ), SSR,   41,26,20 );
   strsplit( d.Ground,             SGP,   52,42,2 );
   strsplit( d.Ground,             SGR,   51,41,2 );
   
   if (d.MFO_Receiver == "")   /* ¯®«ãç¨âì ¨­¨æ¨ «ë ¤«ï £à äë ‚­®á¨â¥«ì*/
     ClearRecord(cl);
     cl.Rec.Name_client = d.Receiver;
     cl.keynum = 10;
     if ( cl.GetEQ() and (cl.Rec.LegalForm == "2"))
        Name_vn = cl.Rec.szShortName;
     end;
   end;

   StrSet(strDateDoc, strlen(strDateDoc), "®");
   strDateDoc = strDateDoc + "¤ ";

   //add George S.Polyakov 30.06.2010
   
   pos=index(d.Payer,"¯ á¯.");
   
   if (pos==0)
     Payer=d.Payer;
     strDoc2="";
   else
     Payer=SubStr(d.Payer,1,pos-2);
     strDoc2="¯ á¯®àâ ” ü "+SubStr(d.Payer,pos+6);
   end;
   strsplit(strDoc2,SD,64,64,2);
   //add George S.Polyakov 30.06.2010
   
   if (Name_vn == "")
    Name_vn = Payer;
   end;

   NM = DoStrSplit( Name_vn, 25, 25, 13);

   

/*
   SetDocParm( acc, d.Account_Payer, d.Code_Currency, @nameDoc, @numbDoc, @placeDoc, @dateDoc );

    if (nameDoc != "")
        strDoc1 = nameDoc + " ü " + numbDoc;
        strDoc2 = "‚ë¤ ­" + " " + placeDoc + " " + dateDoc;
        strDoc1 = String(strDoc1:52);
        strDoc2 = string(strDoc2:52);
    end;
*/
    /*   Š áá®¢ë¥ á¨¬¢®«ë  */
    i = 0;
    while ( i < 20)
        SymbR(i) = "";
        SymbSumR(i) = "";
        SymbP(i) = "";
        SymbSumP(i) = "";
        i = i+1;
    end;

    i = 0; k = 1;
    sc.Kind             = 1;
    sc.iApplicationKind = d.iApplicationKind;
    sc.ApplicationKey   = d.ApplicationKey;

    if(GetEQ(sc))
        if ( CheckTS( sc.Symbol, LSTS_DECR ) )
           SymbR(0)    = sc.Symbol;
           SymbSumR(0) = sc.Sum;
        else
           SymbR(0)    = "";
           SymbSumR(0) = "";
        end;
        if ( CheckTS( sc.Symbol, LSTS_INCR ) )
           SymbP(0)    = sc.Symbol;
           SymbSumP(0) = sc.Sum;
        else
           SymbP(0)    = "";
           SymbSumP(0) = "";
        end;
    else
        if ( CheckTS( d.Symbol_Cach, LSTS_DECR ) )
           SymbR(0)    = d.symbol_cach;
           SymbSumR(0) = d.Sum;
        else
           SymbR(0)    = "";
           SymbSumR(0) = "";
        end;
        if ( CheckTS( d.Symbol_Cach, LSTS_INCR ) )
           SymbP(0)    = d.symbol_cach;
           SymbSumP(0) = d.Sum;
        else
           SymbP(0)    = "";
           SymbSumP(0) = "";
        end;

    end;

    While(next(sc)
         and (sc.Kind             == 1                  )
         and (sc.iApplicationKind == d.iApplicationKind )
         and (sc.ApplicationKey   == d.ApplicationKey   ) )
       if ( CheckTS( sc.Symbol, LSTS_DECR ) )
          SymbR(i)    = sc.Symbol;
          SymbSumR(i) = sc.Sum;
          i = i + 1;
       end;
       if ( CheckTS( sc.Symbol, LSTS_INCR ) )
          SymbP(k)    = sc.Symbol;
          SymbSumP(k) = sc.Sum;
          k = k + 1;
       end;
    end;

    j = 0;
    While( j < i )
       if ((ValType(SymbP(j)) == V_UNDEF) and (ValType(SymbSumP(j)) == V_UNDEF))
          SymbP(j)="";
          SymbSumP(j)="";
       end;
       j = j + 1;
    end;

    j = 0;
    While( j < k )
       if ((ValType(SymbR(j)) == V_UNDEF) and (ValType(SymbSumR(j)) == V_UNDEF))
          SymbR(j)="";
          SymbSumR(j)="";
       end;
       j = j + 1;
    end;


   RNumbDoc = d.Numb_Document;
   PNumbDoc = d.Numb_Document;
   Pdate = StrDateDoc;
   Rdate = StrDateDoc;
   NameReceiver = d.Receiver;
   NamePayer = Payer;
   PBank_Pay = d.Bank_Payer;
   RBank_Pay = PBank_Pay;
   RBank_Rec = d.Bank_Receiver;
   PBank_Rec = RBank_Rec;
   PSum = string(d.Sum:a);
   PSum = StrSubSt( PSum, ".", "-");
   RSum = Psum;
   PayerP = d.Account_Payer;
   PayerR = PayerP;
   ReceiverP = d.Account_Receiver;
   ReceiverR  = ReceiverP;
   BuhP = GetFioOper(d.Oper,true);
   BuhR = BuhP;

   NM1 = DoStrSplit( NameReceiver, 44, 44, 12);
   NM2 = DoStrSplit( NamePayer,    44, 44, 12);
   //add George S.Polyakov 30.06.2010
   NM1 = strsplit2(NamePayer,56,true,12);

   if ( kind_doc == 1) /*¡ã¤¥â § ¯®«­ïâìáï â®«ìª® ¯à¨å®¤­ ï ç áâì */
        RNumbDoc = "";
        Rdate = "";
        NamePayer = "";
        PayerR = "";
        RBank_Pay = "";
        RBank_Rec = "";
        Rsum = "";
        ReceiverR = "";
        BuhR = "";
        strsplit( "", SSR,   31, 16, 50 );
        strsplit( "", SGR,   51, 41, 5 );
        j = 0;
        while ( j < 20)
            SymbR(j) = "";
            SymbSumR(j) = "";
            j = j+1;
         end;
        strDoc1 = ""; strDoc2 = "";
        j=0;
        while ( j<12 )
            NM2(j)="";
            j=j+1;
       end;
   elif ( kind_doc == 2) /*¡ã¤¥â § ¯®«­ïâìáï â®«ìª® à áå®¤­ ï ç áâì */
        PNumbDoc = "";
        Pdate = "";
        NameReceiver = "";
        PayerP = "";
        PBank_Pay = "";
        PBank_Rec = "";
        Psum = "";
        ReceiverP = "";
        BuhP = "";
        strsplit( "", SSP,   32, 17, 50 );
        strsplit( "", SGP,   52, 42, 5 );
        j = 0;
        while ( j < 20)
            SymbP(j) = "";
            SymbSumP(j) = "";
            j = j+1;
         end;
        j=0;
        while ( j<12 )
            NM1(j) = "";
            NM(j)="";
            j=j+1;
       end;
 end;
   [&l0S&l1O&a8L&k2S&l0E&l8D
                                                                                                                            ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                                                                                                                            ³     Š®¤ ä®à¬ë     ³
                                                                                                                            ³ ¤®ªã¬¥­â  ¯® Š“„ ³
                                                                                                                            ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
                                                                                                                            ³      0402007      ³
                                                                                                                            ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
                                               ÚÄÄÄÄÄÄÄ¿                    ³                                               ÚÄÄÄÄÄÄÄ¿
           à¨å®¤­®-à áå®¤­ë© ª áá®¢ë© ®à¤¥à ü ³#######³                    ³           à¨å®¤­®-à áå®¤­ë© ª áá®¢ë© ®à¤¥à ü ³#######³
                                               ÀÄÄÄÄÄÄÄÙ                    ³                                               ÀÄÄÄÄÄÄÄÙ
           #####################                                            ³           #####################
           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                            ³           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
           ˆ•„€Ÿ —€‘’œ                                                  ³           €‘•„€Ÿ —€‘’œ
                                                                            ³
           â ª®£® #########################################################³           ‚ë¤ âì #########################################################
   ]
   (
           PNumbDoc:c,      RNumbDoc:c,
           Pdate:c,         Rdate:c,
           NM1(0):c,  NM2(0):c
   );

      i=1;
      while(i<12)
        if ( (NM1(i)!="") OR (NM2(i)!="") )
   [               #########################################################³                  #########################################################] (NM1(i), NM2(i));
        else
            break;
        end;
      i=i+1;
      end;


   [       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅ           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                               (ä ¬¨«¨ï, ¨¬ï, ®âç¥áâ¢®)                     ³                                 (ä ¬¨«¨ï, ¨¬ï, ®âç¥áâ¢®)
            ­ª-®â¯à ¢¨â¥«ì ################################################³            ­ª-¯®«ãç â¥«ì ################################################
           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅ           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
            ­ª-¯®«ãç â¥«ì #################################################³            ­ª-®â¯à ¢¨â¥«ì ###############################################
           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅ           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                                                     ³   ‘ã¬¬  æ¨äà ¬¨      ³                                                    ³     ‘ã¬¬  æ¨äà ¬¨    ³
                              „……’                  ³ #####################³                           „……’                    ³ #####################³
           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
           ³    ‘ç¥â ü ##############################³    ¢ â®¬ ç¨á«¥       ³           ³    ‘ç¥â ü #############################³    ¢ â®¬ ç¨á«¥       ³
           ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´    ¯® á¨¬¢®« ¬:      ³           ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´    ¯® á¨¬¢®« ¬:      ³
                              Š…„ˆ’                 ³                      ³                           Š…„ˆ’                   ³                      ³
           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
           ³    ‘ç¥â ü ##############################³á¨¬¢®«³     áã¬¬      ³           ³    ‘ç¥â ü #############################³á¨¬¢®«³     áã¬¬      ³
           ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´           ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
           ‘ã¬¬  ¯à®¯¨áìî ###########################³ #### ³###############³           ‘ã¬¬  ¯à®¯¨áìî ##########################³ #### ³###############³
           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
   ]
   (
           PBank_Pay:l,     RBank_Rec:l,
           PBank_Rec:l,     RBank_Pay:l,
           PSum:r,          RSum:r,
           PayerP:l,        PayerR:l,
           ReceiverP:l,     ReceiverR:l,
           SSP(0):l,        SymbP(0):c,      SymbSumP(0):f:r,    SSR(0):l,          SymbR(0):c,      SymbSumR(0):f:r
   );


        [       ##########################################³ #### ³###############³           #########################################³ #### ³###############³
                ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ]
        (SSP(1):l,        SymbP(1):c,      SymbSumP(1):f:r,    SSR(1):l,          SymbR(1):c,      SymbSumR(1):f:r);
        j = 2;
        while ( (SymbP(j+1) != "") OR  (SymbR(j+1) != ""))
        [       ##########################################³ #### ³###############³           #########################################³ #### ³###############³
                ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ]
        (SSP(j):l,        SymbP(j):c,      SymbSumP(j):f:r,    SSR(j):l,          SymbR(j):c,      SymbSumR(j):f:r);
        j = j+1;
        end;

   [       ##########################################³ #### ³###############³           #########################################³ #### ³###############³
           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
           á­®¢ ­¨¥ #######################################################³           á­®¢ ­¨¥ #######################################################
                     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
           #################################################################³           #################################################################
           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
           ‚­®á¨â¥«ì                            ############################³           ãå£ «â¥àáª¨©                 ###################################
    ] (
           SSP(j):l,        SymbP(j):c,      SymbSumP(j):f:r,    SSR(j):l,          SymbR(j):c,      SymbSumR(j):f:r,
           SGP(0):l,        SGR(0):l,
           SGP(1):l,        SGR(1):l,
           NM(0):l,         BuhR:c
      );

        i=1;
        while ( (NM(i) != "") AND ( i<13 ) )
   [                                  ######################################³] (NM(i));
             i=i+1;
        end;



   [                            ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³           à ¡®â­¨ª     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                («¨ç­ ï ¯®¤¯¨áì)    (ä ¬¨«¨ï ¨ ¨­¨æ¨ «ë)    ³                        («¨ç­ ï ¯®¤¯¨áì)       (ä ¬¨«¨ï ¨ ¨­¨æ¨ «ë)
                                                                            ³
           ãå£ «â¥àáª¨©                ####################################³           Š®­âà®«¥à
           à ¡®â­¨ª      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³                        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                         («¨ç­ ï ¯®¤¯¨áì)     (ä ¬¨«¨ï ¨ ¨­¨æ¨ «ë)          ³                        («¨ç­ ï ¯®¤¯¨áì)       (ä ¬¨«¨ï ¨ ¨­¨æ¨ «ë)
                                                                            ³
           ®«ãç¨« ª áá®¢ë©                                                 ³           ®«ãç¨« ¯® ¤®ªã¬¥­âã, ã¤®áâ®¢¥àïîé¥¬ã «¨ç­®áâì,
           à ¡®â­¨ª                                                         ³           #################################################################
                          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                         («¨ç­ ï ¯®¤¯¨áì)     (ä ¬¨«¨ï ¨ ¨­¨æ¨ «ë)          ³           #################################################################
                                                                            ³           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                                            ³           (­ ¨¬¥­®¢ ­¨¥ ¤®ªã¬¥­â , ­®¬¥à, ª¥¬ ¨ ª®£¤  ¢ë¤ ­)
                                                                            ³
                                                                            ³           ‚ë¤ « ª áá®¢ë©
                                                                            ³           à ¡®â­¨ª        ÄÄÄÄÄÄÄÄÄÄÄÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                                            ³                         («¨ç­ ï ¯®¤¯¨áì)        (ä ¬¨«¨ï ¨ ¨­¨æ¨ «ë)
   
   ]
   (
    BuhP:c,
    SD(0):l,
    SD(1):l
   );
end;

 macro PutPlat ( ptr, NumbCopy, action, repname, sf)

  Var   Payer,
        Receiver,
        BIC_Payer,
        CorAcc_Payer,
        BIC_Receiver,
        CorAcc_Receiver,
        dateDoc,DayDateDoc,
        strDateDoc,
        SumStr,  Sum = "",
        StrPayDate,
        inn, kpp, inn_kpp, BS,
        cp, Buhg,it,stat,menu_name,
        mask_ocp, err, Num_p = 0, NumDel = 0,
        okato="",
        cl  = TBFile("client.dbt", "R", 0, "client.dbt", "bank.def"), val = TArray(0, 1), date_318P, data, it1;

  var ac = TBFile("account.dbt", "R", 0, "account.dbt", "bank.def"), client, countSheet =  GlobalReport.GetCountSheet(), ndoc = 1, nsheet = 1, ctgarr = TArray( 0, 1);
  array menu_item, menu_items;
  record ind (arhdoc, "bank.def");

  if ( action == 3 )
       GlobalReport.SetCurSheet( 0 );
       while( Num_p < GlobalReport.GetCountSheet() )
          if ( GlobalReport.GetCurSheet.GetArrPrintStr().size == 0 )
             GlobalReport.SetExecute( string("iBook.Sheets.Item("+ String( Num_p + 1 - NumDel )+").Delete") );
             NumDel = NumDel + 1;
             if ( (Num_p + 1) == countSheet ) /*  #111072   */
                if ( Num_p > 0 )
                   Num_p = Num_p - 1;
                end;
                GlobalReport.SetCurSheet( Num_p);
                break;
             end;
          end;
          Num_p = Num_p + 1;
          if ( Num_p < GlobalReport.GetCountSheet() )
            GlobalReport.SetZoomType(ZOOM_TYPE_A4,1,Num_p);
            GlobalReport.SetCurSheet( Num_p );
          end;
       end;
       GlobalReport.SetExecute( "iSheet=iBook.Sheets.Item(1)" );
  end;

   stat = SetParmPlat( NumbCopy, action, repname );
   if ( (stat != 2) AND (stat != 0) )
       return 0;
   end;

  if (Š®«¨ç¥áâ¢®Š®¯¨© == 0)
    if ( not GetInt(Š®«¨ç¥áâ¢®Š®¯¨©,"‚¢¥¤¨â¥ ª®«¨ç¥áâ¢® ª®¯¨©.",3))
      exit(1);
    end;
  end;

  setbuff( ind, ptr );
  if ( not ˆáª«îç¨âì‚(ind, d) )

      if   ( GetIdentProgram == 129 )   /*  129 - Œ‚„  */
          exit(1);
      elif ( GetIdentProgram == 142 ) /*  142 - âç¥âë  ­ª   */
          return;
      end;
  end;

  it=-1;
  it1 = -1;

  DocToInn( d, 0, 0, inn, kpp );
   inn_kpp = "";

   if ( inn > "" )
      inn_kpp = "ˆ " + inn + " ";
      if ( kpp > "" )
         inn_kpp = inn_kpp + "Š " + kpp + " ";
      end;
   end;

  Payer = inn_kpp + d.Payer;

  DocToInn( d, 0, 1, inn, kpp );
   inn_kpp = "";
   if ( inn > "" )
      inn_kpp = "ˆ " + inn + " ";
      if ( kpp > "" )
         inn_kpp = inn_kpp + "Š " + kpp + " ";
      end;
   end;

  Receiver = inn_kpp + d.Receiver;

  /*Š€’*/
  if( (d.MFO_Receiver == "") AND (d.MFO_Payer == "")  )
  ClearRecord(ac);
  ac.Rec.Account = d.Account_Receiver;
  if ( ac.GetEQ())
    client = ac.Rec.Client;
  end;
  end;
  if ( client)
        if ( GetCtgVal( 3, 335, GetClientID(client), val ) )
            okato = SubStr(val[0], 1, 11);
        end;
    end;

   if( d.MFO_Payer == "" )
      BIC_Payer = {MFO_Bank};
      CorAcc_Payer = {CORAC_Bank};
   else
      BIC_Payer = d.MFO_Payer;
      CorAcc_Payer = d.CorAcc_Receiver;
   end;

   if( d.MFO_Receiver == "" )
      BIC_Receiver = {MFO_Bank};
      CorAcc_Receiver = {CORAC_Bank};
   else
      BIC_Receiver = d.MFO_Receiver;
      CorAcc_Receiver = d.CorAcc_Receiver;
   end;

   if( d.SaveAutoKey > 0 )
      dateDoc = d.Date_Carry;    /* €àå¨¢­ë© ¤®ªã¬¥­â */
   else
      dateDoc = d.Date_Document; /* „®ªã¬¥­â â¥ªãé¥£® ¤­ï */
   end;

   if(sf AND (dateDoc>{curdate}))
     dateDoc={curdate};
   end;

   strDateDoc = String(dateDoc:f:m);
  // Sumstr = ‘ã¬¬ –¨äà ¬¨(d.Sum);

  Sum = string( d.Sum:a);
  Sum = StrSubSt( Sum, ".", "-");

   if(d.Pay_Date != ZeroDate)
    StrPayDate = PutDatePoint(d.Pay_Date);
   else
    StrPayDate = "";
   end;

   GetRegistryValue("MVODB\\„Š“Œ…’›\\„€’€ 318", V_STRING, date_318P, err );
   data = Date(date_318P);

   if ( GetCtgVal( 1, 149, MakeDocumentId( d.iApplicationKind, d.ApplicationKey), ctgarr ) )
        ndoc = ctgarr(0);
   end;

   if ( GetCtgVal( 1, 150, MakeDocumentId( d.iApplicationKind, d.ApplicationKey), ctgarr ) )
        nsheet = ctgarr(0);
   end;

 BS = SubStr(d.Account_Payer,1,3);
 Buhg = GetFioOper(d.Oper,true);
 menu_name = "‚ë¡¥à¨â¥ ä®à¬ã ¤«ï ¯¥ç â¨ ¤®ªã¬¥­â  "+string(d.Numb_Document);
 while(NumbCopy>0)
  if(PrintUNFFlag==false)
  if( (Trim(d.Kind_Oper) == "3") AND (d.Shifr_Oper != "16"))

      if( ( BS == "202" ) AND ( SubStr(d.Account_Receiver,1,3) == "202" ) )
      /* ‘—…’ „……’€ ˆ Š…„ˆ’€ ˆ€„‹…†ˆ’ 202 */

          menu_item(0)="    Œ¥¬®à¨ «ì­ë© ®à¤¥à          ";
          menu_item(1)="    à¨å®¤­ë© ª áá®¢ë© ®à¤¥à    ";
          menu_item(2)="     áå®¤­ë© ª áá®¢ë© ®à¤¥à    ";
          menu_item(3)="    à¨å®¤­®-à áå®¤­ë© ª áá®¢ë© ®à¤¥à    ";
          if(it<0)
             it = Menu(menu_item,null,menu_name);
             if(it <0)
               exit(1);
             end;
          end;
          if   ( it == 0 )
          /* Œ…Œˆ€‹œ›‰ „… */
             PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
          elif ( it == 1 )
          /* ˆ•„›‰ Š€‘‘‚›‰ */
             PrintRC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato, data);
          elif ( it == 2 )
          /* €‘•„›‰ Š€‘‘‚›‰ */
             PrintOC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
          elif ( it == 3 )
          /* ˆ•„ - €‘•„›‰ Š€‘‘‚›‰ */
             menu_items(0)="    à¨å®¤­ ï ¨ à áå®¤­ ï ç áâ¨ ";
             menu_items(1)="    à¨å®¤­ ï ç áâì    ";
             menu_items(2)="     áå®¤­ ï ç áâì    ";
             if(it1<0)
                it1 = Menu(menu_items,null,menu_name);
                if(it1 <0)
                    exit(1);
                end;
             end;

             PrintORC( strDateDoc, Sum, StrPayDate, it1 );
          end;

      elif( BS == "202" )
      /* ‘—…’ „……’€ ˆ€„‹…†ˆ’ 202 */

          if( d.Shifr_Oper == "04" )
            /*šŸ‚‹…ˆ… € ‚‡‘ €‹ˆ—›Œˆ*/
            PrintOVN(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato, data);
          else
             GetRegistryValue("REPORT\\OCP\\OCP_1", V_STRING, mask_ocp, err );
             if ( (err != REG_OK) )
                mask_ocp = "‚";
             end;
             ClearRecord( acc );
             keynum( acc, 0 );
             acc.Account = d.Account_Receiver;
             if ( GetEQ(acc) AND (mask_ocp != "") AND ( CompareStrWithMasks(mask_ocp, acc.Balance) == 0 ) )
                /* €‹€‘‚›‰ ‘—…’€ Š…„ˆ’€ ˆ‘€ ‚ REPORT\\OCP\\OCP_1 */
                asize( menu_item, 0 );
                menu_item(0)="    Œ¥¬®à¨ «ì­ë© ®à¤¥à          ";
                menu_item(1)="    à¨å®¤­ë© ª áá®¢ë© ®à¤¥à    ";
                it = Menu(menu_item,null,menu_name);
                if(it <0)
                  exit(1);
                end;
                if ( it == 0 )
                   /* Œ…Œˆ€‹œ›‰ „… */
                   PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
                else
                   /*ˆ•„›‰ Š€‘‘‚›‰*/
                   PrintRC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
                end;
             else
                /*ˆ•„›‰ Š€‘‘‚›‰*/
                PrintRC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
             end;
          end;

      elif( SubStr(d.Account_Receiver,1,3) == "202" )
      /* ‘—…’ Š…„ˆ’€ ˆ€„‹…†ˆ’ 202 */

         GetRegistryValue("REPORT\\OCP\\OCP_1", V_STRING, mask_ocp, err );
         if ( (err != REG_OK) )
            mask_ocp = "‚";
         end;
         ClearRecord( acc );
         keynum( acc, 0 );
         acc.Account = d.Account_Payer;
         if ( GetEQ(acc) AND (mask_ocp != "") AND ( CompareStrWithMasks(mask_ocp, acc.Balance) == 0 ) )
            /* €‹€‘‚›‰ ‘—…’€ „……’€ ˆ‘€ ‚ REPORT\\OCP\\OCP_1 */
            asize( menu_item, 0 );
            menu_item(0)="    Œ¥¬®à¨ «ì­ë© ®à¤¥à          ";
            menu_item(1)="     áå®¤­ë© ª áá®¢ë© ®à¤¥à    ";
            it = Menu(menu_item,null,menu_name);
            if(it <0)
              exit(1);
            end;
            if ( it == 0 )
               /* Œ…Œˆ€‹œ›‰ „… */
               PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
            else
               /*€‘•„›‰ Š€‘‘‚›‰*/
               PrintOC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
            end;
         else
            /*€‘•„›‰ Š€‘‘‚›‰*/
            PrintOC(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
         end;

      else
      /* ­¨ â®, ­¨ â® ­¨ç¥¬ã ­¥ ¯à¨­ ¤«¥¦¨â */

         /* Œ…Œˆ€‹œ›‰ „… */
         PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, ndoc, nsheet);
      end;

  else
    PrintMO(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, ndoc, nsheet);
  end;

  else

  if( (Trim(d.Kind_Oper) == "3") AND (d.Shifr_Oper != "16"))

      if( ( BS == "202" ) AND ( SubStr(d.Account_Receiver,1,3) == "202" ) )
      /* ‘—…’ „……’€ ˆ Š…„ˆ’€ ˆ€„‹…†ˆ’ 202 */

          menu_item(0)="    Œ¥¬®à¨ «ì­ë© ®à¤¥à          ";
          menu_item(1)="    à¨å®¤­ë© ª áá®¢ë© ®à¤¥à    ";
          menu_item(2)="     áå®¤­ë© ª áá®¢ë© ®à¤¥à    ";
          menu_item(3)="    à¨å®¤­®-à áå®¤­ë© ª áá®¢ë© ®à¤¥à    ";
          if(it<0)
             it = Menu(menu_item,null,menu_name);
             if(it <0)
               exit(1);
             end;
          end;
          if   ( it == 0 )
          /* Œ…Œˆ€‹œ›‰ „… */
             PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
          elif ( it == 1 )
          /* ˆ•„›‰ Š€‘‘‚›‰ */
             PrintReportRP(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
          elif ( it == 2 )
          /* €‘•„›‰ Š€‘‘‚›‰ */
             PrintReportRR(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
          elif ( it == 3 )
          /* ˆ•„ - €‘•„›‰ Š€‘‘‚›‰ */
             menu_items(0)="    à¨å®¤­ ï ¨ à áå®¤­ ï ç áâ¨ ";
             menu_items(1)="    à¨å®¤­ ï ç áâì    ";
             menu_items(2)="     áå®¤­ ï ç áâì    ";
             if(it1<0)
                it1 = Menu(menu_items,null,menu_name);
                if(it1 <0)
                    exit(1);
                end;
             end;

             PrintReportRPR(d, strDateDoc, Sum, StrPayDate, it1);

          end;

      elif( BS == "202" )
      /* ‘—…’ „……’€ ˆ€„‹…†ˆ’ 202 */

          if( d.Shifr_Oper == "04" )
            /*šŸ‚‹…ˆ… € ‚‡‘ €‹ˆ—›Œˆ*/
            PrintOVN(Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp,  okato, data);
            SetOutput( repname, false);
            PrintReportROV(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp,  okato, data);
            SetOutput( null, true);
          else
             GetRegistryValue("REPORT\\OCP\\OCP_1", V_STRING, mask_ocp, err );
             if ( (err != REG_OK) )
                mask_ocp = "‚";
             end;
             ClearRecord( acc );
             keynum( acc, 0 );
             acc.Account = d.Account_Receiver;
             if ( GetEQ(acc) AND (mask_ocp != "") AND ( CompareStrWithMasks(mask_ocp, acc.Balance) == 0 ) )
                /* €‹€‘‚›‰ ‘—…’€ Š…„ˆ’€ ˆ‘€ ‚ REPORT\\OCP\\OCP_1 */
                asize( menu_item, 0 );
                menu_item(0)="    Œ¥¬®à¨ «ì­ë© ®à¤¥à          ";
                menu_item(1)="    à¨å®¤­ë© ª áá®¢ë© ®à¤¥à    ";
                it = Menu(menu_item,null,menu_name);
                if(it <0)
                  exit(1);
                end;
                if ( it == 0 )
                   /* Œ…Œˆ€‹œ›‰ „… */
                   PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
                else
                   /* ˆ•„›‰ Š€‘‘‚›‰ */
                   PrintReportRP(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
                end;
             else
                /*ˆ•„›‰ Š€‘‘‚›‰*/
                PrintReportRP(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, inn, kpp, okato,  data);
             end;
          end;

      elif( SubStr(d.Account_Receiver,1,3) == "202" )
      /* ‘—…’ Š…„ˆ’€ ˆ€„‹…†ˆ’ 202 */

         GetRegistryValue("REPORT\\OCP\\OCP_1", V_STRING, mask_ocp, err );
         if ( (err != REG_OK) )
            mask_ocp = "‚";
         end;
         ClearRecord( acc );
         keynum( acc, 0 );
         acc.Account = d.Account_Payer;
         if ( GetEQ(acc) AND (mask_ocp != "") AND ( CompareStrWithMasks(mask_ocp, acc.Balance) == 0 ) )
            /* €‹€‘‚›‰ ‘—…’€ „……’€ ˆ‘€ ‚ REPORT\\OCP\\OCP_1 */
            asize( menu_item, 0 );
            menu_item(0)="    Œ¥¬®à¨ «ì­ë© ®à¤¥à          ";
            menu_item(1)="     áå®¤­ë© ª áá®¢ë© ®à¤¥à    ";
            it = Menu(menu_item,null,menu_name);
            if(it <0)
              exit(1);
            end;
            if ( it == 0 )
               /* Œ…Œˆ€‹œ›‰ „… */
               PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
            else
               /* €‘•„›‰ Š€‘‘‚›‰ */
               PrintReportRR(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,  data);
            end;
         else
            /* €‘•„›‰ Š€‘‘‚›‰ */
            PrintReportRR(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg, data);
         end;

      else
      /* ­¨ â®, ­¨ â® ­¨ç¥¬ã ­¥ ¯à¨­ ¤«¥¦¨â */

         /* Œ…Œˆ€‹œ›‰ „… */
         PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
      end;

  else
    PrintReportRMO(d,Payer,Receiver,strDateDoc,Sum,BIC_Payer,CorAcc_Payer,BIC_Receiver,CorAcc_Receiver,StrPayDate,Buhg,ndoc,nsheet);
  end;
  end;
  NumbCopy=NumbCopy-1;
  end;

  if(action==0)
     if(NumbCopy > 1)
        GlobalReport.PrintRepCopy(NumbCopy-1);
        println("");
     end;
     SetParmPlat( NumbCopy, 3, repname );
  end;

  end;

 macro PutPlatMO ( ptr, NumbCopy, action, repname, sf)
    PutPlat ( ptr, NumbCopy, action, repname, sf);
 end;